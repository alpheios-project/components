(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{93:function(n,e){angular.module("arethusa.util",[]);var t={formatNumber:function(n,e){var t=parseInt(n,10);if(isNaN(t))return n;for(var i=""+t;i.length<e;)i="0"+i;return i},formatKeyHint:function(n){return n?"("+n+")":""},map:function(n,e,t){if("object"==typeof e){var i=e;e=function(n){return i[n]}}if("string"==typeof e){var a=e;e=function(n){return n[a]}}var r=[];return n.forEach(function(n){if(t){var i=[n];i.push(t.slice(0)),r.push(e.apply(null,i))}else r.push(e(n))}),r},inject:function(n,e,i){if(t.isArray(e))e.forEach(function(e){i(n,e)});else for(var a in e)i(n,a,e[a]);return n},flatten:function(n){for(var e=[],t=0;t<n.length;t++){var i=n[t];(i||!1===i)&&e.push(i)}return e},pushAll:function(n,e){return n.push.apply(n,e),n},findObj:function(n,e){for(var t in n)if(n.hasOwnProperty(t)){var i=n[t];if(e(i))return i}},findNestedProperties:function(n,e){var i=t.toAry(e);return t.inject({},i,function(e,i){var a=function(n,e){var i=[];for(var r in n.hasOwnProperty(e)&&i.push(n),n){var o=n[r];"object"==typeof o&&(o=a(o,e))&&t.pushAll(i,o)}return i};e[i]=a(n,i)})},isArray:function(n){return"[object Array]"===Object.prototype.toString.call(n)},toAry:function(n){return n?t.isArray(n)?n:[n]:[]},intersect:function(n,e){var i;return n.length<e.length&&(i=e,e=n,n=i),n.filter(function(n){return t.isIncluded(e,n)})},isIncluded:function(n,e){return-1!==n.indexOf(e)},empty:function(n){if(t.isArray(n))n.splice(0,n.length);else for(var e in n)n.hasOwnProperty(e)&&delete n[e]},last:function(n){return n[n.length-1]},replaceAt:function(n,e,t){return n.substring(0,e)+t+n.substring(e+1)},isTerminatingPunctuation:function(n){return n.match(/^[\.;:]$/)},xmlParser:new X2JS,xml2json:function(n){return t.xmlParser.xml_str2json(n)},json2xml:function(n){return t.xmlParser.json2xml_str(n)},formatXml:function(n){var e,t="",i="",a=0,r=(n=n.toString().replace(/(>)(<)(\/*)/g,"$1\r\n$2$3")).split("\r\n");for(var o in r){var s=r[o],l=0;s.match(/.+<\/\w[^>]*>$/)?l=0:s.match(/^<\/\w/)?0!==a&&(a-=1):l=s.match(/^<\w[^>]*[^\/]>.*$/)?1:0;for(var c="",u=0;a>u;u++)c+="  ";e=!1;var d=s.match(/<\/(\w*)>/,"$1");if(d){var g=d[1],h=new RegExp("<"+g);i.match(h)&&(t=t.substring(0,t.length-3)+"/>\r\n",e=!0)}e||(t+=c+s+"\r\n"),i=s,a+=l}return t},getProperty:function(n,e){for(var t=e.split("."),i=0;i<t.length&&(n=n[t[i]]);i++);return n},setProperty:function(n,e,t){for(var i=e.split("."),a=i.pop(),r=0;r<i.length;r++){var o=i[r],s=n[o];n=s||(n[o]={})}n[a]=t},copySelection:function(n,e){var i;return t.inject({},e,function(e,a){i=t.getProperty(n,a),angular.isObject(i)&&(i=angular.copy(i)),t.setProperty(e,a,i)})},percentToRgb:function(n,e){var t,i,a,r=Math.floor(120*(100-n)/100),o=e||1;switch(a=[1*(1-o),1*(1-o*((r/=60)-(i=Math.floor(r)))),1*(1-o*(1-(r-i)))],i){case 0:t=[1,a[2],a[0]];break;case 1:t=[a[1],1,a[0]];break;case 2:t=[a[0],1,a[2]];break;case 3:t=[a[0],a[1],1];break;case 4:t=[a[2],a[0],1];break;default:t=[1,a[0],a[1]]}return"#"+t.map(function(n){return("0"+Math.round(255*n).toString(16)).slice(-2)}).join("")},toPercent:function(n,e){return e/n*100},resolveFn:function(n){return function(){n.resolve()}},rejectFn:function(n){return function(){n.reject()}},isArethusaMainApplication:function(){var n=document.querySelector("html").attributes["ng-app"];return n&&"arethusa"==n.value},isUrl:function(n){return n.match(/^https?:\/\//)},capitalize:function(n){return n[0].toUpperCase()+n.slice(1)},find:function(n,e){for(var t,i=0;i<n.length;i++){var a=n[i];if(e(a)){t=a;break}}return t},unique:function(n,e){for(var t=[],i=0;i<n.length;i++){for(var a=n[i],r=!0,o=n.length-1;o>=i+1;o--){if(e(a,n[o])){r=!1;break}}r&&t.push(a)}return t}},i=t;angular.module("arethusa.util").service("commons",[function(){this.setting=function(n,e,t){return new function(n,e,t){this.label=n,this.model=e,angular.isFunction(t)?this.change=t:this.directive=t}(n,e,t)},this.doc=function(n,e,t){return new function(n,e,t){this.xml=n,this.json=e,this.conf=t}(n,e,t)},this.sentence=function(n,e){return new function(n,e){var i=this;this.tokens=n,this.cite=e||"",this.toString=function(){return t.inject([],i.tokens,function(n,e,t){n.push(t.string)}).join(" ")}}(n,e)},this.constituent=function(n,e,t,i,a){return new function(n,e,t,i,a){this.class=n,this.role=e,this.id=t,this.sentenceId=i,this.parent=a,this.isConstituent=!0}(n,e,t,i,a)},this.token=function(n,e){return new function(n,e){this.string=n,this.sentenceId=e,this.isToken=!0}(n,e)}}]),angular.module("arethusa.util").service("generator",[function(){this.panelTrigger=function(n){return{restrict:"A",compile:function(e){function t(n){var t=n();i&&(t+=" ("+i+")"),e.attr("title",t)}var i;return function(e,a,r){function o(){a.toggleClass("on"),n.service.toggle()}function s(){e.$$phase?o():e.$apply(o)}if(n.trsl(n.trslKey,t),a.bind("click",s),n.kC){var l=n.kC.initCaptures(function(e){var t={};return t[n.mapping.name]=[e.create("toggle",function(){s()},n.mapping.key)],t});i=l[n.mapping.name].toggle}}},template:n.template}},this.historyTrigger=function(n,e,t,a){return{restrict:"A",scope:{},link:function(a,r,o){function s(){r.attr("title",l+" "+c)}var l,c;a.history=n,a.$watch("history.mode",function(n,e){"editor"===n?r.show():r.hide()}),a.$watch("history.can"+i.capitalize(t),function(n,e){n?r.removeClass("disabled"):r.addClass("disabled")}),r.bind("click",function(){a.$apply(n[t]())}),a.$watch("history.activeKeys."+t,function(n){n&&(c=i.formatKeyHint(n),s())}),e("history."+t,function(n){l=n(),s()})},template:'<i class="fa fa-'+(a=a||t)+'"/>'}}}]),angular.module("arethusa.util").service("logger",[function(){this.log=function(n){console.log(n)}}]),angular.module("arethusa.core",["angulartics","angulartics.google.analytics","arethusa.util","ngResource","ngCookies","ngAnimate","duScroll","pascalprecht.translate","toaster","oc.lazyLoad","gridster","hljs","mm.foundation","LocalStorageModule","angularUUID2","dndLists"]).value("BASE_PATH","..").constant("_",window._),angular.module("arethusa.core").animation(".slider",["$timeout",function(n){function e(e,t){var i=e[0].clientHeight,a=0,r=500/30,o=i/r;!function t(){e.height(a+"px"),i>a&&n(function(){a+=o,t()},r)}()}function t(n,e){angular.element(n).slideUp(500,e)}return{enter:e,leave:t,addClass:function(n,e,i){"ng-hide"===e&&t(n,i)},removeClass:function(n,t,i){"ng-hide"===t&&e(n)}}}]),angular.module("arethusa.core").controller("ArethusaCtrl",["GlobalErrorHandler","$scope","configurator","state","documentStore","notifier","saver","history","plugins","translator","$timeout","globalSettings",function(n,e,a,r,o,s,l,c,u,d,g,h){var f=d(["loadInProgress","loadComplete"]);e.$on("confLoaded",function(){o.reset(),e.aU=t,e.debug=!1,e.toggleDebugMode=function(){e.debug=!e.debug};var n=a.configurationFor("main");e.state=r,e.plugins=u,e.gS=h,g(function(){s.init(),s.wait(f.loadInProgress()),r.arethusaLoaded=!1,r.init(),l.init(),c.init()}),e.$on("stateLoaded",function(){r.postInit(),r.arethusaLoaded?u.init():e.init()}),e.init=function(){u.start(n.plugins).then(function(){r.arethusaLoaded=!0,s.success(f.loadComplete()),i.isArethusaMainApplication()&&UserVoice.push(["addTrigger","#uservoicebutton",{mode:"contact"}]),r.silent=!1})}})}]),angular.module("arethusa.core").controller("LandingCtrl",["$scope","$window",function(n,e){function t(n,e,t,i){this.name=n,this.caption=e,this.img=a+t,this.url="#/"+i}function i(n,e,t){this.name=n,this.img=a+e,this.href=t}n.template="js/templates/landing_page.html";var a="../dist/examples/images/";n.useCases=[new function(n,e){this.name=n,this.examples=e}("Treebanking",[new t("depTrees","","create1.png","example_tb_create?doc=athenaeus12"),new t("review","","tb_review.png","example_tb_review?doc=11&gold=1"),new t("landing.tryYourself","","create2.png","example_tb_create?doc=clean")])],n.partners=[new i("DH Leipzig","dh_logo.png","http://www.dh.uni-leipzig.de"),new i("Perseids","perseids_logo.png","http://sites.tufts.edu/perseids"),new i("Alpheios","alpheios_logo.png","http://www.alpheios.net"),new i("Perseus","perseus_logo.jpg","http://www.perseus.tufts.edu")],n.awards=[new i("ELCH Uni Graz","elch_banner.png","http://elch.uni-graz.at/?page_id=3158")],n.goTo=function(n){e.open(n)}}]),angular.module("arethusa.core").controller("NavigatorCtrl",["$scope","navigator","translator","keyCapture",function(n,e,a,r){n.next=function(){e.nextChunk()},n.prev=function(){e.prevChunk()},n.goToFirst=function(){e.goToFirst()},n.goToLast=function(){e.goToLast()},n.goTo=function(n){e.goTo(n)},n.nav=e,n.$watch("nav.status",function(e,t){n.navStat=e}),n.$watchCollection("navStat.currentIds",function(e,a){e&&(n.ids=function(n){var e=[],a=[];return e.push(a),n&&angular.forEach(n,function(n,t){var r=i.last(a);r&&parseInt(r)+1!==parseInt(n)?(a=[n],e.push(a)):a.push(n)}),t.map(e,function(n){return n.length>1?n[0]+"-"+n[1]:n[0]}).join(", ")}(e))}),n.trsls=a({"navigator.goToNext":"goToNext","navigator.goToPrev":"goToPrev","navigator.goToFirst":"goToFirst","navigator.goToLast":"goToLast",list:"list"}),n.keys={},n.$watch("nav.keys",function(e){e&&(n.keys.nextChunkKey=i.formatKeyHint(e.navigation.nextChunk),n.keys.prevChunkKey=i.formatKeyHint(e.navigation.prevChunk),n.keys.listKey=i.formatKeyHint(e.navigation.list))})}]),angular.module("arethusa.core").controller("SearchCtrl",["$scope","$location","translator",function(n,e,t){n.search=function(){e.search("doc",n.query)},t("search_documents",function(e){n.search_documents=e()})}]),angular.module("arethusa.core").directive("arethusaGrid",["arethusaGrid","plugins","globalSettings","$timeout",function(n,e,t,i){return{restrict:"A",scope:!0,link:function(e,a,r){angular.element(document.body).css("overflow","auto"),e.grid=n,i(function(){t.defineSetting("grid","custom","grid-setting"),t.defineSetting("gridItems","custom","grid-items")}),e.$on("$destroy",function(){t.removeSetting("grid"),t.removeSetting("gridItems")})},templateUrl:"js/arethusa.core/templates/arethusa_grid.html"}}]),angular.module("arethusa.core").directive("arethusaGridHandle",["$timeout","plugins",function(n,e){return{restrict:"E",scope:!0,link:function(t,i,a,r,o){var s,l=i.find(".drag-handle-trigger"),c=i.find(".drag-handle");l.bind("mouseenter",function(){s=n(function(){t.visible=!0},100)}),l.bind("mouseleave",function(){n.cancel(s)}),c.bind("mouseleave",function(){t.$apply(function(){t.visible=!1})}),t.$on("pluginsLoaded",function(){t.plugin=e.get(t.item.plugin)}),t.$watch("visible",function(n,e){n||(t.settingsOn=!1)})},templateUrl:"js/arethusa.core/templates/arethusa_grid_handle.html"}}]),angular.module("arethusa.core").directive("arethusaNavbar",["configurator","$window",function(n,e){return{restrict:"AE",scope:!0,link:function(t,i,a){function r(){t.windowWidth=s.width(),t.windowWidth,t.logo=o.logo}var o=n.configurationFor("navbar"),s=angular.element(e);r(),s.on("resize",r),t.template=o.template,t.disable=o.disable,t.showSearch=function(){return o.search},t.showNavigation=function(){return o.navigation},angular.element(document.body).css({padding:"45px"})},template:'<div ng-if="!disable" ng-include="template"></div>'}}]),angular.module("arethusa.core").directive("arethusaTabs",["plugins","state","arethusaLocalStorage","_",function(n,e,t,i){var a="tabsConfiguration";return{restrict:"A",scope:{tabs:"=arethusaTabs"},link:function(r,o,s){function l(n){return{name:n.name,label:n.displayName}}function c(n){d(n).active=!0}function u(n){return d(n).active}function d(n){var e=f[n.name];return e||(e=f[n.name]={}),e}function g(){r.visibleTabs=i.inject(r.list,function(n,e){return u(e)&&n.push(h[e.name]),n},[])}var h,f=t.get(a)||{};r.plugins=n,r.state=e,r.moveTab=function(n,e){angular.element(e.toElement).hide(),r.list.splice(n,1),g()},r.toggleTab=function(n){u(n)?function(n){d(n).active=!1}(n):c(n),g(),t.set(a,f)},r.isActive=u,r.$watch("tabs",function(n){n&&(r.list=function(n){return i.map(n,l)}(n),h=function(n){return i.inject(n,function(n,e){return n[e.name]=e,n},{})}(n),r.showSettingsTab=!0,function(n){i.forEach(n,function(n){angular.isDefined(u(n))||c(n)})}(n),g())})},templateUrl:"js/arethusa.core/templates/arethusa_tabs.html"}}]),angular.module("arethusa.core").directive("arethusaUser",[function(){return{restrict:"A",scope:{user:"=arethusaUser",withMail:"@"},link:function(n,e,t){!function(){var e="",t=n.user;t.fullName?(e+=t.fullName,t.name&&(e+=" ("+t.name+")")):e+=t.name,n.name=e}()},templateUrl:"js/arethusa.core/templates/arethusa_user.html"}}]),angular.module("arethusa.core").directive("chunkModeSwitcher",["navigator","notifier","translator",function(n,e,t){return{restrict:"A",scope:{},link:function(i,a,r){i.navi=n;var o=t({"navigator.chunkSizeError":"chunkSizeError"});i.$watch("navi.chunkSize",function(n){i.size=n}),i.tryToSetChunkSize=function(){var t=i.size;n.chunkSize!==t&&(1>t||t>10?(e.error(o.chunkSizeError({max:10})),i.size=n.chunkSize):n.changeChunkSize(i.size))}},templateUrl:"js/arethusa.core/templates/chunk_mode_switcher.html"}}]),angular.module("arethusa.core").directive("closeOnEnter",["$document",function(n){return{restrict:"A",link:function(e,t,i){function a(n){13===n.keyCode&&e.$close(!0)}n.on("keyup",a),e.$on("$destroy",function(){n.off("keyup",a)})}}}]),angular.module("arethusa.core").directive("collectedPluginSettings",["plugins",function(n){return{restrict:"A",scope:{},link:function(e,t,i){e.plugins=n},templateUrl:"js/arethusa.core/templates/collected_plugin_settings.html"}}]),angular.module("arethusa.core").directive("colorizerSetting",["globalSettings",function(n){return{restrict:"A",scope:{},link:function(e,t,i){e.gS=n,e.$watch("gS.settings.colorizer",function(n,t){e.setting=n})},templateUrl:"js/arethusa.core/templates/colorizer_setting.html"}}]),angular.module("arethusa.core").directive("debug",function(){return{restrict:"A",link:function(n,e,t){var i;n.$watch(t.debug,function(n,e){i=n}),n.$watch("debug",function(n,t){n?e.show():e.hide()}),n.prettyTokens=function(){return JSON.stringify(i,null,2)}},template:"<pre>{{ prettyTokens() }}</pre>"}}),angular.module("arethusa.core").directive("delimiter",function(){return{restrict:"A",replace:!0,template:'<div class="small-12 columns" style="padding: 0.5rem 0"/>'}}),angular.module("arethusa.core").directive("deselector",["state","translator",function(n,e){return{restrict:"AE",scope:{},link:function(t,a,r){function o(){a.attr("title",s+" "+l)}var s,l;a.bind("click",function(e){n.deselectAll(),t.$apply()}),t.$on("keysAdded",function(n,e){var t=e.selections;t&&(l=i.formatKeyHint(t.deselect),o())}),e("deselectAll",function(n){s=n(),o()})},template:'<i class="fi-unlock"/>'}}]),angular.module("arethusa.core").directive("dynamicDirective",["$compile",function(n){return{restrict:"A",scope:{directive:"@dynamicDirective"},link:function(e,t,i){var a=t[0].tagName.toLowerCase(),r="<"+a+" "+e.directive+"></"+a+">";t.append(n(r)(e.$parent))}}}]),angular.module("arethusa.core").directive("editors",["editors",function(n){return{restrict:"A",scope:{},link:function(e,t,i){e.editors=n},templateUrl:"js/arethusa.core/templates/editors.html"}}]),angular.module("arethusa.core").directive("exit",["exitHandler","translator",function(n,e){return{restrict:"A",scope:{},link:function(t,i,a){n.defined?(i.bind("click",function(e){var t=e.button;n.leave("_self")}),e("exitHandler.exitTo",function(e){i.attr("title",e({title:n.title}))})):i.hide()},template:'<i class="fa fa-sign-out"></i>'}}]),angular.module("arethusa.core").directive("fireEvent",["state",function(n){return{restrict:"A",controller:["$scope","$element","$attrs",function(e,t,i){var a=e.$eval(i.fireEvent),r=e[a.target],o=e[a.property];e.$watch(a.value,function(e,t){t!==e&&n.fireEvent(r,o,t,e)})}]}}]),angular.module("arethusa.core").directive("focusMe",[function(){return{restrict:"A",scope:{focus:"=focusMe"},link:function(n,e,t){n.$watch("focus",function(n,t){n&&e.focus()})}}}]),angular.module("arethusa.core").directive("foreignKeys",["keyCapture","languageSettings","$compile","globalSettings",function(n,e,t,i){return{restrict:"A",scope:{ngChange:"&",ngModel:"@",foreignKeys:"="},link:function(a,r,o){function s(){return a.foreignKeys||(e.getFor("treebank")||e.getFor("hebrewMorph")||{}).lang}function l(){return e.langNames[s()]}function c(){var n=l(),e=a.enabled?"enabled":"disabled";return n?n+" input "+e+"!":""}function u(n){a.$broadcast("convertingKey",n.keyCode)}function d(n,e){angular.forEach(e,function(e,i){n.append(t(e)(a))})}function g(n,e,t){n.$eval(a.ngModel+" = i + k",{i:e,k:t}),a.ngChange()}a.enabled=!i.disableKeyboardMappings,a.element=r;var h=a.$parent;a.togglerClass=function(){return a.enabled?"success-message-dark":"error-message-dark"},r.attr("placeholder",c),function(){if(l()){var n=r.parent(),e='<div style="margin: '+r.css("margin")+'"/>';r.css("margin",0),d(n,['<span ng-click="visible = !visible">⌨</span>','            <span              ng-click="enabled = !enabled"              class="settings-span-button">              <i                ng-class="togglerClass()"                class="fa fa-power-off"/>            </span>          ',"<div foreign-keys-help/>"]),n.append(e)}}(),a.parseEvent=function(e,t){var i=r[0].value,o=s();if(o){var l=n.getForeignKey(e,o);return!1===l?(u(e),!1):void 0===l||(u(e),r.value=i+l,t?g(h,i,l):a.$apply(g(h,i,l)),!1)}return!0},a.$watch("enabled",function(n,e){n?r.bind("keydown",a.parseEvent):r.unbind("keydown",a.parseEvent),r.attr("placeholder",c)})}}}]),angular.module("arethusa.core").directive("foreignKeysHelp",["keyCapture","languageSettings","$timeout",function(n,e,t){return{restrict:"AE",scope:!0,link:function(i,a,r){function o(){var t=(e.getFor("treebank")||e.getFor("hebrewMorph")||{}).lang;i.keys=n.mappedKeyboard(t,i.shifted)}function s(){i.$apply(function(){i.shifted=!i.shifted,o()})}function l(e,t){"shift"===n.codeToKey(e.keyCode)&&i.$apply(function(){i.shifted=t,o()})}var c,u=i.$watch("visible",function(n,e){n&&((c=a.find(".shifter")).bind("click",s),u())});i.$watch("shifted",function(n,e){c&&(n?c.addClass("key-hit"):c.removeClass("key-hit"))}),i.$on("convertingKey",function(e,a){if(i.visible){var r=document.getElementById(n.codeToKey(a)),o=angular.element(r);o.addClass("key-hit"),t(function(){o.removeClass("key-hit")},450)}}),i.element.on("keydown",function(n){l(n,!0)}),i.element.on("keyup",function(n){l(n,!1)}),i.generate=function(e){var t=n.keyToCode(e);i.parseEvent(new function(n){this.keyCode=n,this.shiftKey=i.shifted}(t),!0),i.shifted=!1,o()},o()},templateUrl:"./js/arethusa.core/templates/foreign_keys_help.html"}}]),angular.module("arethusa.core").directive("fullHeight",["$window",function(n){return{restrict:"A",link:function(e,t,i){function a(n){var e=o.height();t.height(e-s-l)}var r=angular.element(n),o=angular.element(document.body),s=(angular.element(document.getElementById("canvas-border")).height(),t.css("margin-bottom").replace("px","")),l=i.fullHeight||0;r.bind("resize",function(){a()}),a()}}}]),angular.module("arethusa.core").directive("globalClickAction",["globalSettings",function(n){return{restrict:"A",scope:{},link:function(e,t,i){e.gS=n,e.setting=n.settings.clickAction},templateUrl:"js/arethusa.core/templates/global_click_action.html"}}]),angular.module("arethusa.core").directive("globalSettingsPanel",["globalSettings","keyCapture","$timeout",function(n,e,t){return{restrict:"A",scope:{},link:function(i,a,r){i.gS=n,i.kC=e,i.$watch("gS.active",function(n,e){i.active=n,t(function(){n?a.slideDown():a.slideUp()},0,!1)}),i.togglePluginSettings=function(){i.pluginSettingsVisible=!i.pluginSettingsVisible}},templateUrl:"js/arethusa.core/templates/global_settings_panel.html"}}]),angular.module("arethusa.core").directive("globalSettingsTrigger",["generator","globalSettings","translator","keyCapture",function(n,e,t,i){return n.panelTrigger({service:e,trsl:t,trslKey:"globalSettings.title",template:'<i class="fi-widget"/>',kC:i,mapping:{name:"globalSettings",key:"S"}})}]),angular.module("arethusa.core").directive("gridItems",["arethusaGrid","plugins",function(n,e){return{restrict:"A",scope:{},link:function(t,i,a){t.grid=n,t.plugins=e},templateUrl:"js/arethusa.core/templates/grid_items.html"}}]),angular.module("arethusa.core").directive("gridSetting",["arethusaGrid",function(n){return{restrict:"A",scope:{},link:function(e,t,a){e.grid=n,e.settings=n.settings;angular.forEach(["dragging","resizing","floating","pushing"],function(t){e.$watch("settings."+t,function(e,a){e!==a&&n["set"+i.capitalize(t)](e)})})},templateUrl:"js/arethusa.core/templates/grid_setting.html"}}]),angular.module("arethusa.core").directive("helpPanel",["help","keyCapture","globalSettings","versioner","notifier","$timeout",function(n,e,t,i,a,r){return{restrict:"A",scope:{},link:function(o,s,l){o.help=n,o.kC=e,o.gS=t,o.vers=i,o.notifier=a,o.visible={},o.tools=[{label:"Import/Export your morphological data",hint:"Vla",href:"#/morph_tools"}],o.toggle=function(n){o.visible[n]=!o.visible[n]},o.$watch("help.active",function(n,e){o.active=n,r(function(){n?s.slideDown():(s.slideUp(),o.visible={})})})},templateUrl:"js/arethusa.core/templates/help_panel.html"}}]),angular.module("arethusa.core").directive("helpPanelHeading",[function(){return{restrict:"A",scope:{toggler:"@",heading:"@"},link:function(n,e,t){n.toggle=function(){n.$parent.toggle(n.toggler)}},template:'        <p          class="text underline clickable"          translate="{{ heading }}"          ng-click="toggle()">        </p>      '}}]),angular.module("arethusa.core").directive("helpPanelItem",[function(){return{restrict:"A",scope:!0,transclude:!0,link:function(n,e,t){n.toggler=t.toggler,n.heading=t.heading,n.height=t.height},templateUrl:"js/arethusa.core/templates/help_panel_item.html"}}]),angular.module("arethusa.core").directive("helpTrigger",["generator","help","translator","keyCapture",function(n,e,t,i){return n.panelTrigger({service:e,trsl:t,trslKey:"help",template:'<i class="fa fa-question"/>',kC:i,mapping:{name:"help",key:"H"}})}]),angular.module("arethusa.core").directive("keyCapture",["keyCapture",function(n){return{restrict:"A",link:function(e,t,i){t.is("body")||(t=angular.element(document).find("body")),t.on("keydown",function(e){n.keydown(e)}),t.on("keyup",function(e){n.keyup(e)})}}}]),angular.module("arethusa.core").directive("keysToScreen",["$timeout","configurator","keyCapture",function(n,e,i){return{restrict:"A",scope:{},link:function(a,r,o){function s(n){var e,r;return a.actions=t.map(i.keyList[n]||[],function(n){return{str:n}}),e=(n+"").replace(/-/g,"-PLUS-").split("-"),r=t.inject([],e,function(n,e){e.match(/^[A-Z]$/)?t.pushAll(n,["shift","PLUS",e.toLowerCase()]):n.push(e)}),t.map(r,function(n){return new function(n){this.str="PLUS"===n?"+":n,this.joiner="PLUS"===n}(n)})}var l,c,u;e.configurationFor("main").showKeys&&(a.keys=[],a.actions=[],a.$on("keyCaptureLaunched",function(e,i){var r=s(i);a.$apply(function(){u?(a.keys=r,u=!1):t.pushAll(a.keys,r)}),c&&n.cancel(c),l&&n.cancel(l),c=n(function(){u=!0},1500),l=n(function(){a.keys=[],a.actions=[]},3200)}))},templateUrl:"js/arethusa.core/templates/keys_to_screen.html"}}]),angular.module("arethusa.core").directive("langSpecific",["languageSettings",function(n){return{restrict:"A",link:function(e,t,i){var a=n.getFor("treebank")||n.getFor("hebrewMorph");a&&(t.attr("lang",a.lang),t.attr("dir",a.leftToRight?"ltr":"rtl"),t.css("font-family",a.font))}}}]),angular.module("arethusa.core").directive("layoutSetting",["globalSettings",function(n){return{restrict:"A",scope:{},link:function(e,t,i){e.gS=n,e.setting=n.settings.layout},templateUrl:"js/arethusa.core/templates/layout_setting.html"}}]),angular.module("arethusa.core").directive("navbarButtons",["translator",function(n){return{restrict:"A",replace:!0,link:function(e,t,i){e.$watch("windowWidth",function(n,t){var i=n>1150?"":"_collapsed";e.bTemplate="js/arethusa.core/templates/navbar_buttons"+i+".html"}),n("menu",function(n){e.menuTitle=n()})},template:'<ul class="has-form button-group right" ng-include="bTemplate"/>'}}]),angular.module("arethusa.core").directive("navbarNavigation",function(){return{restrict:"A",replace:!0,controller:"NavigatorCtrl",templateUrl:"js/arethusa.core/templates/navbar_navigation.html"}}),angular.module("arethusa.core").directive("navbarNotifier",function(){return{restrict:"A",replace:!0,templateUrl:"js/arethusa.core/templates/navbar_notifier.html"}}),angular.module("arethusa.core").directive("navbarSearch",function(){return{restrict:"A",replace:!0,controller:"SearchCtrl",templateUrl:"js/arethusa.core/templates/navbar_search.html"}}),angular.module("arethusa.core").directive("nextToken",["state",function(n){return{restrict:"AE",link:function(e,t,i){t.bind("click",function(t){e.$apply(n.selectNextToken())})}}}]),angular.module("arethusa.core").directive("notifications",["notifier",function(n){return{restrict:"A",scope:{},link:function(n,e,t){},templateUrl:"js/arethusa.core/templates/notifications.html"}}]),angular.module("arethusa.core").directive("outputter",["$modal","saver","translator",function(n,e,t){return{restrict:"A",scope:{},link:function(i,a,r){i.saver=e,a.bind("click",function(){n.open({templateUrl:"js/arethusa.core/templates/outputter.html",windowClass:"full-modal",scope:i})}),t("saver.previewAndDownload",function(n){a.attr("title",n())})},template:'<i class="fa fa-download"/>'}}]),angular.module("arethusa.core").directive("outputterItem",["fileHandler","$window",function(n,e){return{restrict:"A",link:function(e,t,i){var a;t.addClass("item"),e.data=function(){return a||(a=e.obj.output()),a},e.togglePreview=function(){e.preview=!e.preview},e.download=function(){var t=e.obj.identifier+"."+e.obj.fileType,i=e.obj.mimeType;n.download(t,e.data(),i)}},templateUrl:"js/arethusa.core/templates/outputter_item.html"}}]),angular.module("arethusa.core").directive("plugin",["plugins",function(n){return{restrict:"AE",scope:!0,link:function(e,t,i){e.name={aT:"artificialToken",SG:"sg"}[i.name]||i.name,e.plugin=n.get(e.name),e.withSettings=i.withSettings,e.$on("pluginAdded",function(n,t,i){t===e.name&&(e.plugin=i)})},templateUrl:"js/arethusa.core/templates/plugin.html"}}]),angular.module("arethusa.core").directive("pluginSetting",["userPreferences",function(n){return{restrict:"A",scope:!0,link:function(e,t,i){e.change=function(){var t=e.setting.model,i=e.plugin[t],a=e.setting.change;n.set(e.plugin.name,t,i),angular.isFunction(a)&&a()}},templateUrl:"js/arethusa.core/templates/plugin_setting.html"}}]),angular.module("arethusa.core").directive("pluginSettings",[function(){return{restrict:"A",templateUrl:"js/arethusa.core/templates/plugin_settings.html"}}]),angular.module("arethusa.core").directive("prevToken",["state",function(n){return{restrict:"AE",link:function(e,t,i){t.bind("click",function(t){e.$apply(n.selectPrevToken())})}}}]),angular.module("arethusa.core").directive("relocate",["relocateHandler","translator",function(n,e){return{restrict:"A",scope:{},link:function(e,t,i){n.defined&&(e.locations=n.locations,e.relocate=function(e){n.relocate(e)})},templateUrl:"js/arethusa.core/templates/relocate.html"}}]),angular.module("arethusa.core").directive("resizable",["$window","$document","keyCapture",function(n,e,t){var i=25;return{restrict:"AEC",link:function(a,r,o){function s(n){l(Math.floor(n.pageX))}function l(n){var e=n-Math.round(f.position().left),t=Math.round(f.width())-e,i=g.width()+e;(function(n,e){return n>p&&e>m})(t,i)&&(f.width(t),g.width(i))}function c(){l(Math.round(f.position().left)+i)}function u(){l(Math.round(f.position().left)-i)}function d(){h.trigger("resize"),e.unbind("mousemove",s),e.unbind("mouseup",d)}var g=angular.element(document.getElementById("main-body")),h=angular.element(n),f=r.parent(),p=260,m=260;r.on("mousedown",function(n){n.preventDefault(),e.on("mousemove",s),e.on("mouseup",d)}),t.initCaptures(function(n){return{sidepanelResizing:[n.create("grow",u,"←"),n.create("shrink",c,"→")]}})}}}]),angular.module("arethusa.core").directive("revealToggle",function(){return{restrict:"A",link:function(n,e,t){var i=t.revealToggle,a=t.alwaysReveal,r=t.slide;e.bind("click",function(){var n=angular.element(document.getElementById(i));a||n.hasClass("hide")?(r&&n.slideDown(),n.removeClass("hide"),n.trigger("show-"+i)):(r&&n.slideUp(),n.addClass("hide"),n.trigger("hide-"+i))})}}}),angular.module("arethusa.core").directive("rootToken",["state","globalSettings","depTree",function(n,e,t){return{restrict:"A",scope:{id:"@rootId",sentenceId:"@"},link:function(n,i,a){function r(e){n.$apply(e())}function o(t,a){e.clickAction===s&&e.clickActions[s][1][t](n.id,i,a)}var s="change head";i.bind("click",function(){e.clickAction===s&&r(function(){t.changeHead(new function(){this.id=n.id,this.sentenceId=n.sentenceId})})}),i.bind("mouseenter",function(n){r(function(){i.addClass("hovered"),o("mouseenter",n)})}),i.bind("mouseleave",function(n){r(function(){i.removeClass("hovered"),o("mouseleave",n)})})}}}]),angular.module("arethusa.core").directive("saver",["saver","translator",function(n,e){return{restrict:"A",scope:{},link:function(t,a,r){function o(){l&&l()}function s(){a.attr("title",c+" "+u)}var l,c,u;t.saver=n,a.bind("click",function(){t.$apply(n.save())}),t.$watch("saver.canSave",function(n,e){n?(a.show(),o(),l=t.$watch("saver.needsSave",function(n,e){n?(a.addClass("alert"),a.removeClass("disabled")):(a.addClass("disabled"),a.removeClass("alert"))})):(a.hide(),o())}),t.$on("keysAdded",function(n,e){var t=e.saver;t&&(u=i.formatKeyHint(t.save),s())}),e("save",function(n){c=n(),s()})},template:'<i class="fi-save"/>'}}]),angular.module("arethusa.core").directive("sentence",["navigator",function(n){return{restrict:"A",scope:{sentence:"="},link:function(e,t,i){e.goTo=function(e){n.goTo(e),n.switchView()},e.sentenceString=e.sentence.toString(),e.id=e.sentence.id,n.getCitation(e.sentence,function(n){e.citation=n})},templateUrl:"js/arethusa.core/templates/sentence.html"}}]),angular.module("arethusa.core").directive("sentenceList",["$compile","navigator",function(n,e){return{restrict:"A",scope:!0,link:function(t,i,a){function r(){if(!e.hasList){e.list().append(n('              <div class="canvas-border"/>              <div id="canvas" class="row panel full-height scrollable" full-height>                <ul class="sentence-list">                  <li                     class="sentence-list"                    sentence="s"                    ng-repeat="s in n.sentences">                  </li>                </ul>              </div>            ')(t)),e.hasList=!0}}t.n=e,t.$on("viewModeSwitched",r),i.bind("click",function(){r(),t.$apply(function(){e.switchView()})})}}}]),angular.module("arethusa.core").directive("settingsTrigger",["translator",function(n){return{restrict:"A",replace:!0,link:function(e,t,i){var a=i.settingsTrigger||"left",r="margin-"+("left"===a?"right":"left"),o="left"===a?"":"bw-";t.addClass(a),t.addClass("rotate-"+o+"on-hover"),t.css(r,"10px"),n("settings",function(n){t.attr("title",n())})},templateUrl:"js/arethusa.core/templates/settings_trigger.html"}}]),angular.module("arethusa.core").directive("sidepanel",["sidepanel","keyCapture","plugins",function(n,e,t){return{restrict:"A",link:function(i,a,r){function o(){return t.sub.indexOf(t.active)}function s(){return t.sub.length-1}function l(n){var e=t.sub[n];t.setActive(e)}function c(){var n=o();l(n===s()?d:n+1)}function u(){var n=o();l(n===d?s():n-1)}var d=0,g=e.initCaptures(function(e){return{sidepanel:[e.create("nextTab",function(){e.doRepeated(c)},"W"),e.create("prevTab",function(){e.doRepeated(u)},"E"),e.create("toggle",function(){n.toggle()},"q")]}});angular.extend(n.activeKeys,g.sidepanel)}}}]),angular.module("arethusa.core").directive("sidepanelFolder",["sidepanel","$window","translator",function(n,e,i){return{scope:{},link:function(a,r,o){function s(){var e=n.folded?"expand":"compress",i=n.folded?"show":"fold",o=t.formatKeyHint(n.activeKeys.toggle);a.iconClass="fi-arrows-"+e,r.attr("title",a.translations[i]()+" "+o)}var l=angular.element(e);a.translations=i({"sidepanel.show":"show","sidepanel.fold":"fold"}),a.$watch("translations",function(n,e){n!==e&&s()},!0),r.on("click",function(){n.toggle(),a.$apply(s())}),a.sp=n;var c=function(){};a.$watch("sp.active",function(n){n?(r.show(),c=a.$watch("sp.folded",function(n,e){s(),l.trigger("resize")})):(r.hide(),c())})},template:'<i ng-class="iconClass"/>'}}]),angular.module("arethusa.core").directive("spinner",["spinner",function(n){return{restrict:"A",link:function(e,t,i){e.spinner=n,e.$watch("spinner.spinning",function(n,t){e.visible=n})},template:'<i ng-show="visible" class="fa fa-spinner fa-spin info-message"></i>'}}]),angular.module("arethusa.core").directive("toBottom",["$window","$timeout",function(n,e){return{restrict:"A",link:function(t,a,r){function o(){e(function(){var n=a.offset().top,e=s.offset().top+s.height();a.height(e-n);var t=a.find("svg");t[0]&&(a[0].getBoundingClientRect().bottom,t.offset().top)})}var s;if(i.isArethusaMainApplication()){var l=a.parents(".gridster-item");l[0]?s=l:(s=angular.element(document.getElementById("canvas")),angular.element(n))}else s=a.parents('[ng-controller="ArethusaCtrl"]');angular.element(n).on("resize",o),t.$on("stateLoaded",o),o()}}}]),angular.module("arethusa.core").directive("token",["state","globalSettings",function(n,e){return{restrict:"AE",scope:{token:"=",colorize:"=",click:"@",hover:"@",highlight:"@"},link:function(t,i,a){function r(n){t.$apply(n())}function o(){i.bind("mouseenter",function(){r(function(){n.selectToken(c,"hover")})}),i.bind("mouseleave",function(){r(function(){n.deselectToken(c,"hover")})})}function s(){var n;t.click&&(i.bind("click",function(t){r(function(){var i=t.ctrlKey?"ctrl-click":"click";"click"===i&&n.hasClickSelections()?e.clickFn(c):n.toggleSelection(c,i)})}),i.addClass("clickable"),(n=e.preClickFn)&&angular.forEach(n,function(n,e){i.bind(e,function(e){r(function(){n(c,i,e)})})})),t.hover&&o()}function l(){angular.forEach(t.token.style,function(n,e){i.css(e,"")})}if(t.token){angular.isObject(t.token)||(t.token=n.getToken(t.token)),t.state=n;var c=t.token.id;t.selectionClass=function(){return n.isSelected(c)?"hover"==n.selectionType(c)?"hovered":"selected":void 0},t.$on("clickActionChange",function(){i.removeClass("clickable"),i.unbind(),s()}),t.$watch("colorize",function(n,e){n?angular.isObject(n)?i.css(n):i.css(t.token.style||{}):l()}),t.$watch("token.style",function(n,e){n!==e&&(n?(i.removeAttr("style"),i.css(n)):l())},!0),t.token.artificial&&i.addClass(t.token.type),i.addClass("token"),s()}},templateUrl:"js/templates/token.html"}}]),angular.module("arethusa.core").directive("tokenSelector",["state","_","StateChangeWatcher","Highlighter","translator",function(n,e,t,i,a){return{restrict:"A",scope:{tokens:"=tokenSelector"},link:function(r,o,s){function l(n){return function(e){n.label=e(n)}}function c(n,e){var t="selector."+e;a(t,l(n)),a(t+"Tooltip",function(n){return function(e){n.tooltip=e(n)}}(n))}var u=!0,d=!1,g=r.style||{"background-color":"rgb(255, 216, 216)"};r.state=n,r.$watch("state.hasClickSelections()",function(e,t){u=0===e,d=e===n.totalTokens,k()});var h=new t("head.id",{newMatch:function(e){y.isActive&&n.addStyle(e.id,g)},lostMatch:function(n){y.isActive&&f.removeStyle(n.id)},changedCount:function(n){v.count=n,a("selector.unused",l(v))}}),f=new i(h,g);r.selection={},c(r.selection,"selection");var p={action:function(){n.deselectAll(),f.applyHighlighting()},isActive:!0};c(p,"none");var m={action:function(){n.multiSelect(Object.keys(r.tokens))},isActive:!1};c(m,"all");var v={action:function(){f.unapplyHighlighting(),n.multiSelect(Object.keys(h.matchingTokens))},isActive:!1,count:0};c(v,"unused");var y={action:function(){y.isActive?f.unapplyHighlighting():f.applyHighlighting(),y.isActive=!y.isActive},styleClasses:"unused-highlighter",isActive:!1};c(y,"highlightUnused"),r.selectors=[p,v,y];var k=function(){var t;p.isActive=u,m.isActive=d,v.isActive=!u&&n.hasClickSelections()===h.count&&(t=h.matchingTokens,e.all(Object.keys(t),function(e){return n.isClicked(e)}))};r.$watch("state.tokens",function(n,e){h.initCount()})},templateUrl:"js/arethusa.core/templates/token_selector.html"}}]),angular.module("arethusa.core").directive("tokenWithId",["idHandler",function(n){return{restrict:"A",scope:{value:"=",tokenId:"="},link:function(e,t,i){e.$watch("tokenId",function(t){e.formatted=n.formatId(t,"%s-%w")})},template:'<span>{{ value }} <sup class="note">{{ formatted }}</sup>'}}]),angular.module("arethusa.core").directive("translateLanguage",["$translate","translator","LOCALES",function(n,e,t){return{restrict:"A",scope:{},link:function(i,a,r){function o(e){l=e||n.use()||"en",n.use(l),i.lang=l}function s(){var n;n=(n=t.indexOf(l)+1)>t.length-1?0:n,o(t[n])}var l;a.bind("click",function(){i.$apply(s)});var c=a.parent();e("language",function(n){c.attr("title",n())}),o()},templateUrl:"js/arethusa.core/templates/translate_language.html"}}]),angular.module("arethusa.core").directive("unusedTokenHighlighter",["state","$window","translator","StateChangeWatcher","Highlighter",function(n,e,t,i,a){return{restrict:"A",scope:{highlightMode:"@unusedTokenHighlighter",style:"=unusedTokenStyle",uthCheckProperty:"@",uthAuxiliaryProperty:"@"},link:function(r,o,s){function l(){h.unapplyHighlighting(),n.multiSelect(Object.keys(g.matchingTokens))}var c=r.style||{"background-color":"rgb(255, 216, 216)"},u=!!r.highlightMode;r.s=n,r.total=n.totalTokens;var d={newMatch:function(e){u&&n.addStyle(e.id,c)},lostMatch:function(n){u&&h.removeStyle(n.id)},changedCount:function(n){r.unusedCount=n}},g=new i(r.uthCheckProperty,d,r.uthAuxiliaryProperty);g.initCount();var h=new a(g,c);u&&h.applyHighlighting(),o.bind("click",function(){r.$apply(function(){u?h.unapplyHighlighting():h.applyHighlighting()}),u=!u}),o.bind("dblclick",function(n){return r.$apply(function(){l()}),n.preventDefault(),e.getSelection().empty(),!1}),r.$watch("s.tokens",function(e,t){r.total=n.totalTokens,g.initCount()}),r.$on("tokenAdded",function(n,e){r.total++,g.initCount(),u&&h.applyHighlighting()}),r.$on("tokenRemoved",function(n,e){r.total--}),t("uth.tooltip",function(n){r.tooltip=n()})},template:'      <span      tooltip-html-unsafe="{{ tooltip }}"      tooltip-popup-delay="700"      tooltip-placement="left"      translate="uth.count"      translate-value-count="{{ unusedCount }}"      translate-value-total="{{ total }}">      '}}]),angular.module("arethusa.core").directive("uservoiceEmbed",["translator","uuid2",function(n,e){return{restrict:"A",scope:{target:"@"},link:function(t,i,a){var r="data-uv-embed-"+e.newuuid();angular.forEach(i.children(),function(n,e){angular.element(n).hasClass(t.target)&&angular.element(n).attr("id",r)}),n("errorDialog.sendMessage",function(n){t.hint=n(),UserVoice.push(["embed","#"+r,{mode:"contact",contact_title:"",strings:{contact_message_placeholder:t.hint}}])})}}}]),angular.module("arethusa.core").directive("uservoiceTrigger",["translator",function(n){return{restrict:"A",compile:function(e,t){return e.attr("id","uservoicebutton"),e.attr("data-uv-trigger","contact"),function(e,t){var i=t.parent();n("contactUs",function(n){i.attr("title",n)})}},template:'<i class="fi-comment"/>'}}]),angular.module("arethusa.core").directive("valueWatch",function(){return{restrict:"A",scope:{target:"=",property:"@",emptyVal:"@"},link:function(n,e,t){n.$watch("target."+n.property,function(t,i){t?(n.value=t,e.removeClass("bold")):(n.value=n.emptyVal||"",e.addClass("bold"))})},template:"<span>{{ value }}</span>"}}),angular.module("arethusa.core").factory("Auth",["$resource","$cookies","$timeout","$injector","translator",function(n,e,i,a,r){function o(){return c||(c=a.get("notifier")),c}function s(e,t){if(e){var i=n(e,null,{get:{withCredentials:t}});this.checkAuth=function(n,e){i.get(n,e)}}else this.checkAuth=function(n,e){n()}}function l(){}var c,u=r("auth.notLoggedIn",u,"notLoggedIn");return function(n,a){function r(){return t.isIncluded(h,a())}function c(n){403===n.status&&(g=!0,o().warning(u.notLoggedIn(),null,500))}var d=this;d.conf=n;var g,h=n.skipModes||[];this.withCredentials=!!n.crossDomain;var f=new s(n.ping,this.withCredentials);this.checkAuthentication=function(){r()||f.checkAuth(l,c)},this.withAuthentication=function(n,e){var t=function(e){c(e),n.reject(e)},a=function(e){g=!1,n.resolve(e)},o=function(){e().then(a,t)};if(!g||r())o();else{f.checkAuth(function(){i(o,150)},t)}},this.transformRequest=function(n){"CSRF"==d.conf.type&&(n()[d.conf.header]=e[d.conf.cookie])}}}]),angular.module("arethusa.core").factory("confUrl",["CONF_PATH","$route",function(n,e){return function(t){var i=e.current.params,a=n+"/";return i.conf?a+i.conf+".json":i.conf_file?i.conf_file:t?a+"default.json":void 0}}]),angular.module("arethusa.core").factory("DocumentResolver",["configurator","_",function(n,e){return function(t){function i(n,e){var i=t.map[e];return i?n[i]:void 0}var a=n.provideResource(t.resource);this.resolve=function(n,t){a.get().then(function(a){var r=a.data;e.forEach(r,function(e,a){var r=i(n,a);if(r){var o={doc:e};r.get(o,t(r))}})})}}}]),angular.module("arethusa.core").factory("globalStore",[function(){return{}}]),angular.module("arethusa.core").factory("Highlighter",["state",function(n){return function(e,t){var i=this;this.applyHighlighting=function(){e.applyToMatching(function(e){n.addStyle(e,t)})},this.removeStyle=function(e){var i=Object.keys(t);n.removeStyle(e,i)},this.unapplyHighlighting=function(){e.applyToMatching(function(n){i.removeStyle(n)})}}}]),angular.module("arethusa.core").factory("Resource",["$resource","$q","locator","spinner",function(n,e,i,a){function r(n){return n?n.match("json"):void 0}function o(n,e){return angular.extend(function(n){return t.inject({},n,function(n,e,t){n[e]=i.get(e)})}(n),e)||{}}function s(n,e){var t={};return t.data=r(e()["content-type"])?JSON.parse(n):n,t.headers=e,t.source="tbd",t}return function(t,i){function a(){return l=e.defer(),n(c.route,null,{get:{method:"GET",withCredentials:i.withCredentials,transformResponse:s,timeout:l.promise},save:{method:"POST",withCredentials:i.withCredentials,transformRequest:function(n,e){var t=c.mimetype||"application/json";return e()["Content-Type"]=t,r(t)&&(n=angular.toJson(n)),c.auth.transformRequest(e),n},transformResponse:s}})}var l,c=this;this.route=t.route,this.params=t.params||[],this.auth=i,i.checkAuthentication(),this.resource=a(),this.get=function(n){var e=o(c.params,n);return c.resource.get(e).$promise},this.save=function(n,t){var a=o(c.params,{});c.mimetype=t;var r=e.defer(),s=r.promise;return i.withAuthentication(r,function(){return c.resource.save(a,n).$promise}),s},this.post=this.save,this.abort=function(){l.resolve(),c.resource=a()}}}]),angular.module("arethusa.core").factory("StateChange",["$parse",function(n){return function(e,t,i,a,r,o){var s=this,l=n(i),c=l.assign;this.token=function(n,e){return angular.isObject(e)?e:n.getToken(e)}(e,t),this.property=i,this.newVal=a,this.oldVal=l(s.token),this.type="change",this.time=new Date,this.undo=function(){return angular.isFunction(r)?r():void e.change(s.token,i,s.oldVal)},this.exec=function(){return angular.isFunction(o)&&o(),c(s.token,s.newVal),e.broadcast("tokenChange",s),e.notifyWatchers(s),s}}}]),angular.module("arethusa.core").factory("StateChangeWatcher",["state","$parse",function(n,e){return function(t,i,a){function r(n){var e=o.auxiliaryProperty;return e?n&&n[e]:n}var o=this;this.checkFunction=function(n,t){var i=e(n);return t?function(n){var e=i(n);return e&&e[t]}:i}(t,a),this.auxiliaryProperty=a,this.initCount=function(){o.count=0,o.matchingTokens={},angular.forEach(n.tokens,function(n){o.checkFunction(n)||(o.count++,o.matchingTokens[n.id]=!0)}),i.changedCount(o.count)},this.watchChange=function(n,e,t){var a=t.token.id;r(n)?r(e)||(o.count--,delete o.matchingTokens[a],i.lostMatch(t.token),i.changedCount(o.count)):(o.count++,o.matchingTokens[a]=!0,i.newMatch(t.token),i.changedCount(o.count))},this.applyToMatching=function(n){angular.forEach(o.matchingTokens,function(e,t){n(t)})},n.watch(t,this.watchChange),n.on("tokenAdded",function(n,e){o.checkFunction(e)||(o.matchingTokens[e.id]=!0,i.newMatch(e),o.count++,i.changedCount(o.count))}),n.on("tokenRemoved",function(n,e){o.checkFunction(e)||(delete o.matchingTokens[e.id],i.lostMatch(e),o.count--,i.changedCount(o.count))})}}]),angular.module("arethusa.core").factory("translator",["$rootScope","$translate","$interpolate",function(n,e,i){function a(){}function r(n,r,o){var s=angular.isFunction(r),l=function(n){t.setProperty(r,o,n)};s||l(a),e(n,null,"nullInterpolator").then(function(n){var e=i(n);s?r(e):l(e)})}function o(e,t,i){r(e,t,i),n.$on("$translateChangeSuccess",function(){r(e,t,i)})}return function(n,e,t){return e=e||{},angular.isObject(n)?angular.isArray(n)?angular.forEach(n,function(n){o(n,e,n)}):angular.forEach(n,function(n,t){o(t,e,n)}):o(n,e,t),e}}]),angular.module("arethusa.core").factory("translatorNullInterpolator",function(){return{getInterpolationIdentifier:function(){return"nullInterpolator"},interpolate:function(n){return n},setLocale:function(){}}}),angular.module("arethusa.core").factory("Tree",["$compile","languageSettings","keyCapture","idHandler","$window","state","$timeout","translator","plugins","navigator",function(n,e,a,r,o,s,l,c,u,d){return function(g,h,f){function p(e){var t=g.$new();return V.childScopes.push(t),t.obj=e.relation,n(on)(t)[0]}function m(e){var t,i=g.$new();return V.childScopes.push(i),i.token=e,g.styles?(function(n){return(g.styles[n.id]||{}).token}(e)&&function(n,e){n.style=g.styles[e.id].token}(i,e),t="style"):t="true",n(rn.replace("STYLE",t))(i)[0]}function v(n,e,t,i){if(t){var a={};angular.forEach(t,function(n,t){a[t]=e.style(t)}),i[n]=a}}function y(n){return V.vis.select("#"+k(n))}function k(n){return"tep"+n}function b(n){return V.vis.select("#"+w(n))}function w(n){return"tel"+n}function S(n){return V.vis.select("#"+function(n){return"tph"+n}(n))}function x(n){return V.g._nodes[n]}function C(n){if(R()){n||(g.groupedTokens=i.map(d.currentSentences,"tokens"),g.groupSize=g.groupedTokens.length);var e=g.current;if(g.current=g.groupedTokens[g.currentFocus],function(n,e){return n&&e?angular.equals(Object.keys(n),Object.keys(e)):void 0}(g.current,e))return}else g.current=g.tokens;V.vis&&V.vis.selectAll("*").remove(),V.g=new dagreD3.Digraph,f.syntheticRoot&&(q=r.getId("0",A()),V.g.addNode(q,{label:'<div id="tph'+q+'">'+Y+"</div>"})),angular.forEach(g.current,function(n,e){(function(n){return i.getProperty(n,f.mainAttribute)})(n)&&V.drawEdge(n)}),E()}function A(){for(var n in g.current)break;return g.current[n].sentenceId}function T(n){V.g.addNode(n.id,{label:function(n){return'<div class="node token-node" id="tph'+n.id+'">'+n.string+"</div>"}(n)})}function j(n){(function(n){return y(n)[0][0]})(n.id)&&V.g.delEdge(n.id),V.drawEdge(n)}function $(n){n.$destroy()}function _(){angular.forEach(V.childScopes,$),V.childScopes=[],f.syntheticRoot&&S(q).append(function(){return this.textContent="",n('<span root-token root-id="'+q+'" sentence-id="'+A()+'">'+Y+"</span>")(g)[0]}),V.insertNodeDirectives(),V.insertEdgeDirectives()}function E(){V.vis=en.select("g"),an.layout(g.layout).run(V.g,V.vis),_(),V.vis.selectAll("g.edgePath path").each(function(n){angular.element(this).attr("id",k(n))}).attr("marker-end",""),V.vis.selectAll(function(){return this.getElementsByTagName("foreignObject")}).each(function(){var n=angular.element(this);if(n.find(".node").length){var e=n.attr("width");n.attr("width",parseInt(e)+1)}angular.element(this.children[0]).attr("style","float: center;"),angular.element(this).attr("overflow","visible")}),l(function(){h.find(".token").removeClass("no-transition")})}function I(){var n=e.getFor("treebank");return!n||n.leftToRight}function M(n,e,t){!function(n,e,t){tn.translate([n,e]),tn.scale(t||1)}(n,e,t);var i="translate("+n+","+e+" )",a=t?" scale("+t+")":"";V.vis.transition().attr("transform",i+a).duration(X).ease()}function P(n,e){if(n){e=e||G;var t=function(n){return function(n){var e=n.attr("transform"),t=/translate\((.*),(.*?)\)/.exec(e);return new function(n,e){this.x=n,this.y=e}(t[1],t[2])}(angular.element(S(n)[0]).parents(".node"))}(n);M(nn-t.x,0-t.y+e)}}function D(){return V.vis.node().getBBox()}function F(){Z=J.width(),Q=J.height(),nn=Z/2,Q/2}function L(){angular.isDefined(B)&&B()}function O(n){B=n}function z(n){C(n),D().width>Z-2*G?g.perfectWidth():g.centerGraph(),R()&&u.declareReady(f.parentPlugin)}function R(){return g.tokens===s.tokens}function H(n){return g.current[n]}function U(){var e;g.compactTree=V.compactTree,g.wideTree=V.wideTree,g.textDirection=I(),g.rankDir="BT","vertical"===f.direction&&g.changeDir(),g.compactTree(),g.layout=dagreD3.layout().sortRankByIdAscending(g.textDirection).rankDir(g.rankDir).nodeSep(g.nodeSep).edgeSep(g.edgeSep).rankSep(g.rankSep),g.currentFocus=0,g.$watch("tokens",function(){z()}),g.$watch("currentFocus",function(n,e){n!==e&&z(!0)}),K()||h.parents("#sidepanel").length?dn.addClass("no-border"):dn.removeClass("no-border"),h.append(J),e='<span class="right" ng-include="'+"panelTemplate"+'"/>',angular.element(h[0].previousElementSibling).append(n(e)(g)),h.prepend(n("<div dep-tree-navigator/>")(g)),F()}function N(){return h.parents(".gridster")}function K(){return N().length}var q,B,V=this,G=15,W='        <svg class="full-height full-width">          <g transform="translate('+G+","+G+')"/>        </svg>      ',J=angular.element(W),X=700,Y="[ROOT]";this.g=void 0,this.vis=void 0;var Q,Z,nn,en=d3.select(h[0]),tn=d3.behavior.zoom();en.call(tn.on("zoom",function(){var n,e;B=void 0,e="translate("+(n=d3.event).translate+") scale("+n.scale+")",V.vis.attr("transform",e)}).scaleExtent([.3,2.5]));var an=new dagreD3.Renderer;an.transition(function(n){return n.transition().duration(X)}),g.settingsOn=!1;var rn='        <span token="token"          style="white-space: nowrap"          class="no-transition"          colorize="STYLE"          click="true"          hover="true"/>      ',on='        <span         value-watch         target="obj"         property="label"         empty-val="NIL"/>      ';g.panelTemplate=function(n){return"js/arethusa.dep_tree/templates/"+n+".html"}("settings");var sn={},ln={};this.drawEdge=function(n){var e=n.id;if(angular.isDefined(e)){var t=i.getProperty(n,f.mainAttribute);x(e)||T(n),x(t)||T(g.current[t]),V.g.addEdge(e,e,t,{label:function(n){return'<div id="'+w(n.id)+'" class="text-center tree-label">xxxxxxxxxxx</div>'}(n)})}},g.changeDir=function(){var n;I()?n="RL":(n="LR",g.textDirection=!g.textDirection),g.rankDir="BT"===g.rankDir?n:"BT"},g.centerGraph=function(){O(g.centerGraph),M((Z-D().width)/2,G)},g.perfectWidth=function(){O(g.perfectWidth);var n=D().width;M(G,G,(Z-2*G)/n)},g.focusRoot=function(){O(g.focusRoot),P(q)},g.focusSelection=function(){O(g.focusSelection),P(s.firstSelected(),Q/3)},g.$watch("styles",function(n,e){n!==e&&(_(),n?(V.vis.selectAll("g.edgePath path"),angular.forEach(g.styles,function(n,e){var t=n.label,i=n.edge,a=b(e),r=y(e);t&&a[0][0]&&(v(e,a,t,ln),a.style(t)),i&&r[0][0]&&(v(e,r,i,sn),r.style(i))})):(angular.forEach(sn,function(n,e){y(e).style(n)}),sn={},angular.forEach(ln,function(n,e){b(e).style(n)}),ln={}))});var cn,un={nodeSep:function(n){g.layout.nodeSep(n)},edgeSep:function(n){g.layout.edgeSep(n)},rankSep:function(n){g.layout.rankSep(n)},rankDir:function(n){g.layout.rankDir(n)},textDirection:function(n){g.layout.sortRankByIdAscending(n)}};(angular.forEach(un,function(n,e){g.$watch(e,function(e,t){e!==t&&(n(e),E(),l(L,X))})}),R())&&(s.on("tokenAdded",function(n,e){H(e.id)&&(T(e),_(),E())}),s.on("tokenRemoved",function(n,e){var t=e.id;H(t)&&x(t)&&(V.g.delNode(t),E())}),s.watch(f.mainAttribute,function(n,e,t){var i=t.token;if(H(i.id)){if(n!==e&&(function(n){return!(angular.isDefined(n)&&""!==n)}(n)?V.g.delEdge(i.id):j(i)),s.batchChange)return void(cn=!0);E(),l(L,X)}}),s.on("batchChangeStop",function(){cn&&(E(),l(L,X),cn=!1)}));angular.element(o).on("resize",function(){F(),L()});var dn=h.parents(".tree-canvas"),gn=a.initCaptures(function(n){return{tree:[n.create("directionChange",function(){g.changeDir()},"x"),n.create("centerTree",function(){g.centerGraph()},"s"),n.create("focusRoot",function(){g.focusRoot()}),n.create("focusSelection",function(){g.focusSelection()},"a"),n.create("perfectWidth",function(){g.perfectWidth()},"d")]}});g.keyHints=t.inject({},gn.tree,function(n,e,i){n[e]=t.formatKeyHint(i)}),g.$on("$destroy",gn.$destroy),g.translations={};angular.forEach(["changeDir","focusRoot","focusSel","centerTree","perfectWidth","compact","widen"],function(n,e){c("tree."+n,g.translations,n)}),this.launch=function(){K()&&!N().hasClass("gridster-loaded")?l(U,130):U()},this.createEdges=function(){},this.nodePresent=x,this.createNode=T,this.insertNodeDirectives=function(){V.insertTokenDirectives()},this.insertTokenDirectives=function(){V.vis.selectAll("div.node.token-node").append(function(){return this.textContent="",m(g.current[this.id.slice(3)])})},this.insertEdgeDirectives=function(){angular.forEach(g.current,function(n,e){b(e).append(function(){return this.textContent="",p(n)})})},this.compactTree=function(){g.nodeSep=30,g.edgeSep=10,g.rankSep=30},this.wideTree=function(){g.nodeSep=80,g.edgeSep=5,g.rankSep=40},this.childScopes=[]}}]),angular.module("arethusa.core").factory("urlParser",[function(){function n(n,e){return n+"="+e}function e(e,t){var i=e.url.replace(t.search,"?"),a=[];angular.forEach(e.params,function(e,t){angular.isArray(e)?angular.forEach(e,function(e){a.push(n(t,e))}):a.push(n(t,e))}),e.url=i+a.join("&")}function i(n){var i=this,a=document.createElement("a");a.href=n,this.url=n,this.params=function(n){var e=n.search.slice(1).split("&");return t.inject({},e,function(n,e){var i=e.split("="),a=i[0],r=i[1]||!0,o=n[a],s=o?t.toAry(o).concat([r]):r;n[a]=s})}(a),this.set=function(n,t){angular.isString(n)&&t&&(this.params[n]=t),e(i,a)}}return function(n){return new i(n)}}]),angular.module("arethusa.core").factory("User",[function(){return function(n){this.name=n.name,this.fullName=n.fullName,this.mail=n.mail,this.page=n.page}}]),angular.module("arethusa.core").filter("keys",function(){return function(n){return n?Object.keys(n):[]}}),angular.module("arethusa.core").constant("LANDING",{controller:"LandingCtrl",template:'    <div style="height: 100%; overflow: auto">      <div        ng-include="template"         class="fade slow">      </div>    </div>  ',resolve:{scrollBody:function(){angular.element(document.body).css("overflow","auto")},conf:["configurator",function(n){n.defineConfiguration({navbar:{template:"js/templates/navbar_landing.html"}})}]}}),angular.module("arethusa.core").constant("MAIN_ROUTE",{controller:"ArethusaCtrl",template:'    <div>      <arethusa-navbar></arethusa-navbar>      <div        ng-include="gS.layout.template"         class="fade slow">      </div>    </div>  ',resolve:{loadConfiguration:["$http","confUrl","configurator",function(n,e,t){var i=e(!0);return n.get(i).then(function(n){t.defineConfiguration(n.data,i)})}]}}),angular.module("arethusa.core").constant("MORPH_TOOLS",{controller:"MorphToolsCtrl",templateUrl:"js/arethusa.tools/templates/morph_tools.html",resolve:{latinAttrs:["$http",function(n){return n.get("js/arethusa.morph/configs/morph/lat_attributes.json")}],greekAttrs:["$http",function(n){return n.get("js/arethusa.morph/configs/morph/gr_attributes2.json")}]}}),angular.module("arethusa.core").service("arethusaGrid",["gridsterConfig","$window","plugins","$rootScope","notifier","globalSettings",function(n,e,i,a,r,o){function s(n,e,t,i){return e=e||[],t=t||[],{sizeX:e[0],sizeY:e[1],row:t[0],col:t[1],plugin:n,style:i}}function l(n,e){e.grid&&(c(),u.itemList=t.inject({},i.all,function(n,e,t){n[e]=!1}),angular.forEach(u.items,function(n,e){u.itemList[n.plugin]=!0}))}function c(){u.items=t.map(o.layout.grid,function(n){return new s(n.plugin,n.size,n.position,n.style)})}var u=this,d=angular.element(e);this.settings={dragging:!0,resizing:!0,pushing:!0,floating:!0},this.setDragging=function(n){u.options.draggable.enabled=n},this.setResizing=function(n){u.options.resizable.enabled=n},this.setPushing=function(n){u.options.pushing=n},this.setFloating=function(n){u.options.floating=n},this.options=angular.extend(n,{columns:48,rowHeight:"match",defaultSizeX:6,defaultSizeY:4,resizable:{enabled:u.settings.resizing,handles:["n","e","s","w","ne","nw","se","sw"],stop:function(){d.triggerHandler("resize")}},draggable:{enabled:u.settings.dragging,handle:".drag-handle"}}),this.addItem=function(n){u.items.push(new s(n)),r.success(n+" added to the grid!")},this.removeItem=function(n){var e=u.items.indexOf(function(n){for(var e,t=u.items.length-1;t>=0;t--){var i=u.items[t];if(i.plugin===n){e=i;break}}return e}(n));u.items.splice(e,1),r.info(n+" removed from grid!")},this.toggleItem=function(n){u.itemList[n]?u.addItem(n):u.removeItem(n)},this.init=function(){a.$on("layoutChange",l),l(0,o.layout)},c(),a.$on("pluginsLoaded",u.init),i.loaded&&u.init()}]),angular.module("arethusa.core").service("arethusaLocalStorage",["localStorageService",function(n){function e(n){return-1===t.indexOf(n)?n:JSON.parse(n)}this.get=function(t){return e(n.get(t))},this.set=n.set,this.keys=n.keys;var t=["true","false","null"]}]),angular.module("arethusa.core").service("configurator",["$injector","$http","$rootScope","Resource","Auth","$timeout","$location","$q",function(n,e,i,a,r,o,s,l){function c(){var n=d.configuration.main.globalDefaults||{},e=t.inject({},["mode"],function(n,e){var t=s.search()[e];t&&(n[e]=t)});return angular.extend({},{mode:"editor"},n,e)}var u,d=this,g=["main","navbar","notifier"];this.getConfTemplate=function(){return new function(){this.main={},this.plugins={},this.resources={}}},this.mergeConfigurations=function(n,e){var i=this;return angular.forEach(e,function(e,a){var r=n[a];r?angular.isArray(r)?t.pushAll(r,e):angular.isObject(r)?i.mergeConfigurations(r,e):n[a]=e:n[a]=e}),n},this.shallowMerge=function(n,e){function t(n,e,t,i){e?angular.extend(e,t):i[n]=t}return function(n,e){angular.forEach(g,function(i,a){var r=n[i],o=e[i];o&&t(i,r,o,n)});var i=n.main,a=e.main;a&&angular.extend(i,a)}(n,e),function(n,e){var i=n.plugins,a=e.plugins;a&&angular.forEach(a,function(e,a){t(a,i[a],e,n)})}(n,e),n},this.delegateConf=function(e,i,a){function r(){return u||(u=n.get("userPreferences")),u}var o=a?i:t.pushAll(["displayName","main","template","external","contextMenu","contextMenuTemplate","noView","mode"],i),s=e.defaultConf||{},l=function(n){return void 0!==n&&null!==n};angular.forEach(o,function(n,t){if(!a||!l(e[n])){var i=r().get(e.name,n),o=e.conf[n],c=l(i)?i:l(o)?o:s[n];e[n]=c}}),e.displayName||(e.displayName=e.name),function(n){angular.forEach(c(),function(e,t){void 0===n[t]&&(n[t]=e)})}(e)},this.getConfAndDelegate=function(n,e){return n.conf=d.configurationFor(n.name),d.delegateConf(n,e),n},this.getStickyConf=function(n,e){return n.conf=d.configurationFor(n.name),d.delegateConf(n,e,!0),n},this.configuration=this.getConfTemplate(),this.defineConfiguration=function(n,e){this.configuration=angular.extend(d.getConfTemplate(),n),this.confFileLocation=e,o(function(){i.$broadcast("confLoaded")})},this.loadAdditionalConf=function(i){function a(){return n.get("notifier")}var r=t.inject([],i,function(n,t,i){var r;if("fullFile"==t){r=e.get(function(n){return n.match("^http://")?n:d.configuration.main.auxConfPath+"/"+n+".json"}(i)).then(function(n){d.shallowMerge(d.configuration,n.data),a().info(i+" configuration loaded!")},function(){a().warning("Failed to retrieve "+i)})}else r=e.get(i).then(function(n){angular.extend(d.configurationFor(t),n.data)});n.push(r)});return l.all(r)},this.configurationFor=function(n){var e=d.configuration;return e[n]||e.plugins[n]||e.resources[n]||{}},this.addPluginConf=function(n,e){d.configuration.plugins[n]=e},this.getRetrievers=function(n){return t.inject({},n,function(n,e,t){var i=d.getService(e);n[e]=new i(t)})},this.getPersisters=this.getRetrievers,this.getRetriever=function(n){var e=d.getRetrievers(n);return e[Object.keys(e)[0]]},this.getService=function(e){return n.get(e)},this.getServices=function(n){if(n){var e=this;return t.inject({},n,function(n,t){n[t]=e.getService(t)})}return{}},this.provideResource=function(n){var e=d.configuration.resources[n];if(e)return new a(e,d.provideAuth(e.auth))},this.provideAuth=function(n){return new r((d.configuration.auths||{})[n]||{},d.mode)},this.mode=function(){return c().mode}}]),angular.module("arethusa.core").service("confirmationDialog",["$modal","$rootScope",function(n,e){this.ask=function(t){var i=e.$new();i.message=t;var a=n.open({templateUrl:"js/arethusa.core/templates/confirmation_dialog.html",windowClass:"confirmation-modal",scope:i}).result;return a.finally=function(){i.$destroy()},a}}]),angular.module("arethusa.core").service("dependencyLoader",["$ocLazyLoad","$q","BASE_PATH",function(n,e,t){var a=this;this.load=function(e){return n.load(function(n){function e(n){return i.isUrl(n)?n:t+"/"+n}if(angular.isArray(n))return i.map(n,e);if(angular.isString(n))return e(n);var a=i.map(n.files,e);return n.files=a,n}(e))},this.loadInOrder=function(n){var t=e.defer(),r=[t.promise];return angular.forEach(n,function(n,t){var o=e.defer();r.push(o.promise),r[t].then(function(){a.load(n).finally(i.resolveFn(o))})}),t.resolve(),i.last(r)}}]),angular.module("arethusa.core").service("documentStore",function(){var n=this;this.reset=function(){this.store={},this.confs={}},this.addDocument=function(e,t){n.store[e]=t,function(e){angular.extend(n.confs,e.conf)}(t)},this.hasAdditionalConfs=function(){return!angular.equals(n.confs,{})},this.reset()}),angular.module("arethusa.core").service("editors",["User",function(n){var e=this;this.perDocument={},this.addEditor=function(t,i){var a=e.perDocument[t];a||(a=e.perDocument[t]=[]),a.push(new n(i)),e.editorsPresent=!0},this.editorsPresent=!1}]),angular.module("arethusa.core").service("errorDialog",["$modal","$rootScope",function(n,e,t){function i(t,i){var a=e.$new();a.message=t,a.trace=i;var r=n.open({templateUrl:"js/arethusa.core/templates/error_dialog.html",windowClass:"error-modal",scope:a}).result;return r.finally=function(){a.$destroy()},r}this.sendError=function(n,e){i(n,e?printStackTrace({e:e}):printStackTrace()).then(function(){})}}]),angular.module("arethusa.core").service("exitHandler",["$location","$window","configurator","$analytics","$rootScope",function(n,e,i,a,r){function o(){return t.inject({},g,function(e,t){e[t]=n.search()[t]})}function s(){var n=o(),e=d,i=t.inject({},n,function(n,t,i){e.indexOf(":"+t)>-1?e=e.replace(":"+t,i):n[t]=i});return function(n,e){return angular.equals({},e)||(n+="?",n+=t.inject([],e,function(n,e,t){n.push(e+"="+t)}).join("&")),n}(e,i)}function l(){r.$broadcast(c)}var c="exit:leave",u=i.configurationFor("exitHandler")||{};this.defined=!angular.equals({},u),this.title=u.title;var d=u.route,g=u.params;this.leave=function(n){a.eventTrack("exit",{category:"actions",label:"exit"}),n=n||"_self",l(),e.open(s(),n)},this.onLeave=function(n){r.$on(c,n)},this.triggerLeaveEvent=l}]),angular.module("arethusa.core").service("fileHandler",["$window",function(n){function e(e){return(n.URL||n.webkitURL).createObjectURL(e)}function t(n){document.body.appendChild(n),n.click(),document.body.removeChild(n)}var i,a;this.upload=function(e,a){return angular.isDefined(n.FileReader)?(i||((i=document.createElement("input")).setAttribute("type","file"),i.addEventListener("change",function(e,t){return function(t){var i=t.target.files[0],a=new n.FileReader;a.onload=function(n){e(function(n,e){return JSON.parse(n)}(n.target.result))},a.readAsText(i)}}(e))),void t(i)):void alert("Your browser does not support this feature - use Chrome, Firefox or Opera")},this.download=function(n,i,r){if(a||(a=document.createElement("a")),angular.isDefined(a.download)){var o=new Blob([i],{type:r+";charset=utf-8"});a.setAttribute("href",e(o)),a.setAttribute("download",n),t(a)}else alert("Your browser does not support this feature - use Chrome, Firefox or Opera")}}]),angular.module("arethusa.core").service("globalSettings",["configurator","plugins","$injector","$rootScope","notifier","translator","keyCapture","$timeout",function(n,e,i,a,r,o,s,l){function c(){return g||(g=i.get("state")),g}function u(){f.conf=n.configurationFor("main").globalSettings||{},n.delegateConf(f,m,!0),f.defineSetting("persistSettings"),f.defineSetting("chunkMode","custom","chunk-mode-switcher"),f.defineSetting("clickAction","custom","global-click-action"),f.defineSetting("alwaysDeselect"),f.defineSetting("disableKeyboardMappings"),f.defineSetting("colorizer","custom","colorizer-setting"),f.defineSetting("layout","custom","layout-setting")}function d(){if(!(f.layouts.length<2)){var n=(f.layouts.indexOf(f.layout)+1)%f.layouts.length;f.layout=f.layouts[n],f.broadcastLayoutChange()}}var g,h,f=this;f.name="globalSettings",f.layout={},f.colorizers={disabled:!0};var p=o({"globalSettings.layoutLoaded":"layoutLoaded"}),m=["alwaysDeselect","colorizer","persistSettings","disableKeyboardMappings"];f.defaultConf={alwaysDeselect:!1,colorizer:"morph",persistSettings:!0,disableKeyboardMappings:!1},f.settings={},this.defineSetting=function(n,e,t,i){f.settings[n]=new function(n,e,t,i){this.property=n,this.label=i||"globalSettings."+n,this.type=e||"checkbox",this.directive=t}(n,e,t,i)},this.removeSetting=function(n){delete f.settings[n]},this.propagateSetting=function(n){(h||(h=i.get("userPreferences")),h).set(f.name,n,f[n])},this.toggle=function(){f.active=!f.active};var v={};this.deselectAfterAction=function(n){v[n]=!0},this.noDeselectAfterAction=function(n){v[n]=!1},this.shouldDeselect=function(n){return f.alwaysDeselect||v[n]},this.defaultClickAction=function(n){c().toggleSelection(n,"click")},this.clickActions={},this.addClickAction=function(n,e,t){f.clickActions[n]=[e,t]},this.removeClickAction=function(n){delete f.clickActions[n],f.clickAction===n&&f.setClickAction("disabled")},this.setClickAction=function(n,e){if(f.clickAction!==n){f.clickAction=n;var t=f.clickActions[f.clickAction];f.clickFn=t[0],f.preClickFn=t[1],e||a.$broadcast("clickActionChange")}},this.addColorizer=function(n){f.colorizers[n]=!0},this.isColorizer=function(n){return f.colorizer===n},this.applyColorizer=function(){"disabled"===f.colorizer?c().unapplyStylings():f.colorizers[f.colorizer]&&e.get(f.colorizer).applyStyling()},this.colorMaps=function(){return t.inject({},f.colorizers,function(n,t,i){"disabled"!==t&&(n[t]=e.get(t).colorMap())})},a.$on("confLoaded",function(){f.layouts=n.configurationFor("main").layouts,f.layout=f.layouts[0],f.broadcastLayoutChange()}),this.broadcastLayoutChange=function(){l(function(){r.info(p.layoutLoaded({layout:f.layout.name}))},500),a.$broadcast("layoutChange",f.layout)},s.initCaptures(function(n){return{layout:[n.create("cycle",d,"l")]}}),this.init=function(){u(),f.addClickAction("disabled",f.defaultClickAction),f.setClickAction("disabled",!0)}}]),angular.module("arethusa.core").service("help",[function(){var n=this;this.toggle=function(){n.active=!n.active},n.active=!1}]),angular.module("arethusa.core").service("idHandler",["errorDialog",function(n){function e(e,t,i){var a=!1;return angular.isDefined(l[i])||(l[i]={}),angular.isDefined(l[i][e])||(l[i][e]={}),l[i][e][t]||(a=l[i][e][t]=!0),a||n.sendError("Unexpected error calculating token mappings for sourceid: "+t),a}function a(n){return/(\d*)(\w*)?/.exec(n)}function r(n){return n.split("-")}function o(n,e){var t=r(n),i=t.pop(),o=t.pop(),l=a(i),u=l[1],d=l[2]||"";return d?d=e?function(n){var e=c.indexOf(n)+1;return c[e]}(d):function(n){var e=c.indexOf(n)-1;return c[e]}(d):e?u++:u--,s.getId(u,o)+d}var s=this,l={};this.getId=function(n,e){var i=e?t.formatNumber(e,4):"",a=t.formatNumber(n,4);return i?i+"-"+a:a},this.padIdWithSId=function(n,e){return i.formatNumber(e,4)+"-"+n},this.formatId=function(n,e){if(n){e=e||"%w";var i,o=r(n),s=a(o.pop()),l=t.formatNumber(s[1]),c=t.formatNumber(o.pop(),0);return i=e.replace("%w",l+(s[2]||"")),e.indexOf(!1)&&(i=c?i.replace("%s",c):i.replace("%s-","")),i}},this.unassignSourceId=function(n){n.idMap.clearSourceIdAssignments(n.sentenceId)},this.Map=function(){var n=this;this.mappings={},this.add=function(t,i,a,r){return angular.isDefined(r)&&e(r,a,t)&&(n.mappings[t]=new function(n,e){this.internalId=n,this.sourceId=e}(i,a)),n.mappings[t]},this.sourceId=function(e){var t=n.mappings[e];return t?t.sourceId:void 0},this.clearSourceIdAssignments=function(e){angular.forEach(Object.keys(n.mappings),function(t,i){l[t][e][n.sourceId(t)]=!1})}},this.transformToSourceIds=function(n,e,i){var a=new function(){var n=this;this.mapped={},this.unmapped=[],this.fullMap={},this.add=function(e,t,i){var a=e.idMap.sourceId(t),r=e.id;a?(n.mapped[a]=e,n.fullMap[r]=a):(n.unmapped.push(e),a=i(),angular.isDefined(e.idMap.add(t,r,a,e.sentenceId))&&(n.fullMap[r]=a))}};return t.inject(a,n,function(n,t,a){n.add(a,e,i)})};for(var c=[],u=97;123>u;u++)c.push(String.fromCharCode(u));this.isExtendedId=function(n){return n.match(/.*[a-z]$/)};this.extendId=function(n){return n+"e"},this.stripExtension=function(n){return s.isExtendedId(n)?n.slice(0,-1):n},this.decrement=function(n){return o(n,!1)},this.increment=function(n){return o(n,!0)},this.nonSequentialIds=function(n){var e={};return angular.forEach(n,function(t,i){var a=n[i+1];a&&s.decrement(a)!==t&&(e[i]=!0)}),e}}]),angular.module("arethusa.core").service("keyCapture",["configurator","$rootScope",function(n,e){function i(n){return(c.conf("keys")||{})[n]||{}}function a(n){var e=n.keyCode;return n.shiftKey&&(e+=c.shiftModifier),n.ctrlKey&&(e+=c.ctrlModifier),n.altKey&&(e+=c.altModifier),n.metaKey&&(e+=c.metaModifier),e}function r(n){e.$broadcast("keyCaptureLaunched",y[n]||n)}function o(n){if(!isNaN(n)){var e=parseInt(n)-48;return e>-1&&10>e}}function s(n){return function(){for(var e=n.length-1;e>=0;e--)n[e]()}}function l(n,e){var t=n.indexOf(e);n.splice(t,1)}var c=this;this.conf=function(e){return(n.configurationFor("keyCapture")||{})[e]||{}};for(var u={return:13,"↵":13,shift:16,ctrl:17,alt:18,esc:27,up:38,down:40,left:37,right:39,"←":37,"→":39,"↑":38,"↓":40,":":186,"[":219,"'":222,"]":221},d=97;123>d;d++)u[String.fromCharCode(d)]=d-32;var g=t.inject({},u,function(n,e,t){n[t]=e});this.codeToKey=function(n){return g[n]},this.keyToCode=function(n){return u[n]},this.shiftModifier=1e3,this.ctrlModifier=2e3,this.altModifier=4e3,this.metaModifier=8e3,this.getKeyCode=function(n){var e=function(n){var e=n.split("-"),i=e.pop();return i.match(/[A-Z]/)&&(t.isIncluded(e,"shift")||e.push("shift"),i=i.toLowerCase()),[e,u[i]]}(n),i=e[0],a=e[1];return angular.forEach(i,function(n,e){var t;switch(n){case"ctrl":t=c.ctrlModifier;break;case"shift":t=c.shiftModifier;break;case"alt":t=c.altModifier;break;case"meta":t=c.metaModifier}a+=t}),a};var h=[];this.getForeignKey=function(n,e){if(!n.altKey&&!n.ctrlKey){var a=[],r=i(e),o=g[n.keyCode],s=r.modifiers;if(o){if("shift"==o)return;if(n.shiftKey&&a.push("shift"),t.isIncluded(function(n){return Object.keys(n.modifiers)}(r),o)){a.push(o);var l=a.join("-");return h.push(l),!1}if(t.isIncluded(a,"shift")){var c=a.indexOf("shift");a.splice(c,1),o=o.toUpperCase()}a.push(o)}var u=r[function(n,e){var t=n.length-1,i=n[t],a=n.slice(0,t);return a.sort(function(n,t){return e[n]-e[t]}),a.concat(i)}(h.concat(a),s).join("-")];return h=[],u}};var f={},p=function(n){var e=a(n),t=f[e];t&&(function(n,e){angular.forEach(n,function(n,t){k||n.callback(e)})}(t,n),k=!1)},m=["INPUT","TEXTAREA","SELECT"];this.keydown=function(n){if(!t.isIncluded(m,n.target.tagName)&&!o(n.keyCode)){var e=a(n);f[e]&&r(e)}};var v="";this.keyup=function(n){if(!t.isIncluded(m,n.target.tagName)){if(o(n.keyCode)){var e=n.keyCode-48;return r(e),void(v+=e)}p(n),v=""}},this.doRepeated=function(n){for(var e=parseInt(v,10)||1;e>0;e--)n()};var y={};this.onKeyPressed=function(n,e,t){var i=c.getKeyCode(n);!function(n,e){y[n]=e}(i,n);var a=f[i]||[],r=new function(n,e){this.callback=n,this.priority=e||0}(e,t);return a.push(r),f[i]=function(n){return n.sort(function(n,e){return e.priority-n.priority})}(a),function(){l(f[i],r)}};var k=!1;this.stopPropagation=function(){k=!0},this.create=function(n,e,t){return new function(n,e,t){this.confKey=n,this.fn=e,this.defaultKey=t}(n,e,t)},this.initCaptures=function(n){var i=[],a=t.inject({},n(c),function(n,t,a){var r=c.conf(t);angular.forEach(a,function(a,o){var s=r[a.confKey]||a.defaultKey;if(angular.isDefined(s)){!function(n,e,t,i){n[e]||(n[e]={}),n[e][t]=i}(n,t,a.confKey,s);var l=c.onKeyPressed(s,function(){e.$apply(a.fn)});i.push(l)}})});return angular.equals({},a)||(e.$broadcast("keysAdded",a),i.push(function(n){var e=[];return angular.extend(c.activeKeys,n),angular.forEach(n,function(n,t){angular.forEach(n,function(n,i){var a=c.keyList[n];a||(a=c.keyList[n]=[]);var r=t+"."+i;a.push(r),e.push(function(){var e=c.activeKeys[t]||{},o=e[i];n===o&&delete e[i],l(a,r)})})}),s(e)}(a))),a.$destroy=s(i),a},this.mappedKeyboard=function(n,e){var t=i(n),a=c.conf("keys").us,r=[],o=["lower","upper"];return o=e?o.reverse():o,angular.forEach(a,function(n,e){n.show=[],angular.forEach(o,function(e,i){!function(n,e,t){var i=e.show,a=e[t];a&&(n[a]?i.push(n[a]):(function(n,e){var t=n.style;t.class=t.class||{},void 0===n.hide&&(t.class[{lower:"0",upper:"1"}[e]]="inactive")}(e,t),i.push(a)))}(t,n,e)}),r.push(n)}),r},this.activeKeys={},this.keyList={}}]),angular.module("arethusa.core").service("languageSettings",["documentStore",function(n){var e=this;this.languageSpecifics={ara:{name:"Arabic",lang:"ar",leftToRight:!1,font:"Amiri"},grc:{name:"Greek",lang:"gr",leftToRight:!0},heb:{name:"Hebrew",lang:"he",leftToRight:!1}},this.langNames=t.inject({},e.languageSpecifics,function(n,e,t){n[t.lang]=t.name});var i={};this.setFor=function(n,t){i[n]=e.languageSpecifics[t]},this.getFor=function(t){var a=i[t];if(a)return a;var r=n.store[t];if(void 0!==r){var o=r.json.treebank||r.json.book;if(o){var s=o["_xml:lang"];if(s in e.languageSpecifics){var l=e.languageSpecifics[s];return e.setFor("treebank",l),l}}}}}]),angular.module("arethusa.core").service("locator",["$location",function(n){var e,t={};this.get=function(i){return e?t[i]:n.search()[i]},this.watchUrl=function(n){e=!n},this.set=function(n,e){e?t[n]=e:angular.extend(t,n)}}]),angular.module("arethusa.core").service("navigator",["$injector","configurator","$cacheFactory","keyCapture","$rootScope","globalSettings",function(n,e,i,a,r,o){function s(n,e){return[n.author,n.work,e].join(" ")}function l(n){x.status.citation=n}function c(){delete x.status.citation,x.getCitation(u(),l)}function u(){var n=x.currentPosition;return x.currentSentences||(x.currentSentences=x.sentences.slice(n,n+x.chunkSize)||[]),x.currentSentences}function d(n){x.currentPosition=n}function g(){return(o.layout.navigator||{}).chunkSize||x.conf.chunkSize||1}function h(n){var e=x.currentPosition+n*x.chunkSize;0>e&&(e=0),x.currentPosition=e,k()}function f(){x.status.hasNext=m(),x.status.hasPrev=v()}function p(){x.currentSentences=void 0,w=void 0,x.currentChunk()}function m(){return x.currentPosition+x.chunkSize<x.sentences.length}function v(){return x.currentPosition>0}function y(){x.hasList=!1}function k(){x.updateId(),r.$broadcast(S),(x.lazyState||(x.lazyState=n.get("state")),x.lazyState).replaceState(x.currentChunk())}var b,w,S="navigator:move",x=this,C={},A=i("citation",{number:100});this.getCitation=function(n,e){if(b){var t=n[0];if(t){var i=t.cite;i&&(function(n){return n.match(/urn:cts/)}(i)?function(n,e){var t,i=function(n){var e=n.lastIndexOf(":");return[n.slice(0,e),n.slice(e+1)]}(n),a=i[0],r=i[1];(t=A.get(a))?e(s(t,r)):b.get({cite:a}).then(function(n){t=n.data,A.put(a,t),e(s(t,r))})}(i,e):e(i))}}},this.sentenceToString=function(n){return t.inject([],n.tokens,function(n,e,t){n.push(t.string)}).join(" ")},this.addSentences=function(n){t.pushAll(x.sentences,n),angular.forEach(n,function(n,e){x.sentencesById[n.id]=n}),f(),p()},this.goToFirst=function(){d(0),k()},this.goTo=function(n){var e=function(n){for(var e,t=x.sentences.length-1;t>=0;t--)if(x.sentences[t].id===n){e=x.sentences[t];break}return e}(n);if(e)return d(x.sentences.indexOf(e)),k(),!0;alert("No sentence with id "+n+" found")},this.goToByPosition=function(n){x.sentences.length>n&&(d(n),k())},this.goToLast=function(){d(x.sentences.length-x.chunkSize),k()},this.applyChunkMode=function(){},this.changeChunkSize=function(n){x.chunkSize!==n&&(x.chunkSize=n,k())},this.currentChunk=function(){if(!w){w={};for(var n=u(),e=0;e<n.length;e++)angular.extend(w,n[e].tokens);t=u(),i=t[0],a=t[t.length-1],r=x.sentences.indexOf(i),o=x.sentences.indexOf(a),C.pre=function(n){return 0!==n?x.sentences[n-1]:void 0}(r),C.post=function(n){return n!==x.sentences.length-1?x.sentences[n+1]:void 0}(o)}var t,i,a,r,o;return w},this.nextChunk=function(){m()&&h(1)},this.prevChunk=function(){v()&&h(-1)},this.markChunkChanged=function(){for(var n=u(),e=n.length-1;e>=0;e--)n[e].changed=!0},this.addToken=function(n){var e=n.sentenceId,t=n.id;x.sentencesById[e].tokens[t]=n},this.removeToken=function(n){var e=n.sentenceId,t=n.id;delete x.sentencesById[e].tokens[t]},this.list=function(){return angular.element(document.getElementById("arethusa-sentence-list"))},this.switchView=function(){r.$broadcast("viewModeSwitched");var n=angular.element(document.getElementById("arethusa-editor")),e=x.list();x.listMode?(n.removeClass("hide"),e.addClass("hide"),x.listMode=!1):(n.addClass("hide"),e.removeClass("hide"),x.listMode=!0)},this.init=function(){x.conf=e.configurationFor("navigator"),x.chunkModes=["sentence"],x.chunkMode=x.conf.chunkMode||"sentence",x.chunkSize=g(),x.sentences=[],x.sentencesById={},x.status={context:C},d(0),b=e.provideResource("citeMapper"),x.keys=a.initCaptures(function(n){return{navigation:[n.create("nextChunk",function(){n.doRepeated(x.nextChunk)},"u"),n.create("prevChunk",function(){n.doRepeated(x.prevChunk)},"i"),n.create("list",function(){x.switchView()},"L")]}}),navigator.chunkMode="sentence",r.$on("layoutChange",function(n,e){x.changeChunkSize(g())})},this.reset=function(){d(0),x.sentences=[],x.sentencesById={},x.listMode=!1,y(),x.updateId()},this.updateId=function(){f(),p(),x.status.currentPos=x.currentPosition,x.status.currentIds=t.map(u(),"id"),c()},this.onMove=function(n){return r.$on(S,n)},r.$on("tokenChange",x.markChunkChanged),r.$on("tokenAdded",x.markChunkChanged),r.$on("tokenRemoved",x.markChunkChanged),r.$on("layoutChange",y)}]),angular.module("arethusa.core").service("notifier",["configurator","toaster","$timeout",function(n,e,t){function i(n){return function(){t.cancel(o[n])}}function a(n,e){o[n]=t(i,e,!1)}var r=this;this.messages=[];angular.forEach(["success","info","wait","warning","error"],function(n){r[n]=function(e,t,i){r.disable||r.addMessage(n,e,t,i)}});var o={};this.addMessage=function(n,t,i,s){r.messages.length===r.maxMessages&&r.messages.pop();var l=function(n,e,t){return[n,e,t].join("||")}(n,t,i);if(!function(n){return o[n]}(l)){s&&a(l,s);var c=new function(n,e,t){this.type=n,this.message=e,this.title=t,this.time=new Date}(n,t,i);r.messages.unshift(c),e.pop(n,i,t)}},this.toggle=function(){r.panelActive=!r.panelActive},this.init=function(){r.conf=n.configurationFor("notifier"),r.disable=r.conf.disable,r.maxMessages=r.conf.maxMessages||15}}]),angular.module("arethusa.core").service("plugins",["configurator","$injector","$rootScope","$q","$timeout","dependencyLoader","notifier","translator",function(n,e,t,a,r,o,s,l){function c(e){if("history"===e){var t=a.defer();return t.resolve(),t.promise}var i=new function(n,e){var t=this;this.name=function(n,e){return e?n:"arethusa."+n}(n,e),this.files=[function(n){return n||"dist/"+function(n){return n.replace(/([A-Z])/g,"_$1").toLowerCase()}(t.name)+".min.js"}(e)]}(e,n.configurationFor(e).location);return o.load(i)}function u(n){function e(n){var e=a.defer();return n().finally(i.resolveFn(e)),e.promise}if(angular.isArray(n))return o.load(n);var t=n.ordered,r=n.unordered,s=[];return t&&s.push(e(function(){return o.loadInOrder(t)})),r&&s.push(e(function(){return o.load(r)})),a.all(s)}function d(n){var t=n.replace(/.*?\./,"");return e.get(t)}function g(n,e){r(function(){t.$broadcast("pluginAdded",e,n)})}var h,f,p=this,m=l({"plugins.added":"added","plugins.failed":"failed","plugins.alreadyLoaded":"alreadyLoaded"});this.setActive=function(n){p.active=n},this.isActive=function(n){return p.isSelected(n)&&!n.alwaysActive},this.isSelected=function(n){return n===p.active},this.doAfter=function(n,e){f.add("after",n,e)},this.declareReady=function(n){var e="string"==typeof n?n:n.name;h[e]=!0,f.resolve("after",e)},this.get=function(n){return(p.all||{})[n]||{}},this.addPlugin=function(t,i){if(!p.all[t]){i&&n.addPluginConf(t,i);var r,o=a.defer(),l=o.promise,d=function(){p.all[t]=r,p.registerPlugin(r),r.init(),g(r,t),s.success(m.added({name:t})),o.resolve(r)},h=function(){s.error(m.failed({name:t})+"!"),o.reject()};return c(t).then(function(){var n=(r=e.get(t)).externalDependencies;n?u(n).then(d,h):d()},h),l}s.warning(m.alreadyLoaded({name:t}))},this.registerPlugin=function(n,e){(function(n){return!(!n.template||n.noView)})(n)&&(n.main?p.main.push(n):p.sub.push(n)),n.contextMenu&&p.withMenu.push(n)},this.init=function(){h={},f=new function n(){var e=this,t=n;this.after={},this.before={},t.prototype.resolve=function(n,t){var i=e[n][t]||[];angular.forEach(i,function(n,e){n()})},t.prototype.add=function(n,t,i){var a=e[n],r=a[t];r||(r=a[t]=[]),r.push(i),h[t]&&i()}},angular.forEach(p.all,function(n){angular.isFunction(n.init)&&n.init()})},this.start=function(n){p.loaded=!1,p.loader={},p.all={};var e=a.defer();return function(n){function e(n,e){(function(n){return Object.keys(p.loader).length===n.length})(n)&&e.resolve()}var t=a.defer();return angular.forEach(n,function(i,a){var r,o=c(i);o.then(function(){var n=d(i).externalDependencies;n?r=u(n):p.loader[i]=d(i)},function(){p.loader[i]=!1}),o.finally(function(){r?r.finally(function(){p.loader[i]=d(i),e(n,t)}):e(n,t)})}),t.promise}(n).then(function(){(function(n){angular.forEach(n,function(n,e){var t=p.loader[n];t&&(p.all[n]=t)})})(n),p.init(),p.main=[],p.sub=[],p.withMenu=[],angular.forEach(p.all,p.registerPlugin),p.setActive(p.sub[0]),angular.forEach(p.all,g),p.loader={},p.loaded=!0,t.$broadcast("pluginsLoaded"),e.resolve()}),e.promise}}]),angular.module("arethusa.core").service("relocateHandler",["$location","$window","configurator","$analytics",function(n,e,t,i){function a(e){return r[e].baseUrl+n.url()}var r=t.configurationFor("relocateHandler")||{};this.defined=!angular.equals({},r),this.locations=this.defined?Object.keys(r):[],this.relocate=function(n,t){i.eventTrack("relocate",{category:"actions",label:n}),t=t||"_self",e.open(a(n),t)}}]),angular.module("arethusa.core").service("routeChangeWatcher",["$rootScope","$window",function(n,e){n.$on("$locationChangeSuccess",function(){e.location.reload()})}]),angular.module("arethusa.core").service("saver",["configurator","notifier","keyCapture","state","$rootScope","$window","translator","$analytics","exitHandler",function(n,e,t,a,r,o,s,l,c){function u(){var e;m=n.configurationFor("main"),v=n.getPersisters(m.persisters),k.outputters=(e=i.inject({},v,function(n,e,t){angular.isFunction(t.output)&&(n[e]=t)}),angular.extend(e,n.getPersisters(m.outputters)))}function d(){!angular.equals({},v)&&"editor"===n.mode()&&(k.canSave=!0)}function g(n){k.needsSave=!1,r.$broadcast(y),e.success(b.success())}function h(n){406==n.status?g():e.error(b.error())}function f(n,e){n.saveData(g,h)}function p(){k.needsSave=!0}var m,v,y="saveSuccess",k=this,b=s({"saver.success":"success","saver.error":"error","saver.inProgress":"inProgress","saver.nothingToSave":"nothingToSave","saver.confirmNote":"confirmNote","saver.confirmQuestion":"confirmQuestion"});this.save=function(){l.eventTrack("save",{category:"actions",label:"save"}),k.needsSave?(e.wait(b.inProgress()),angular.forEach(v,f)):e.info(b.nothingToSave())},a.debug||(o.onbeforeunload=function(n){return k.needsSave?b.confirmNote():void c.triggerLeaveEvent()},r.$on("$locationChangeStart",function(n){k.needsSave&&(o.confirm(b.confirmNote()+"\n"+b.confirmQuestion())||n.preventDefault())}),r.$on("destroy",function(){o.onbeforeunload=void 0})),this.onSuccess=function(n){r.$on(y,n)},this.init=function(n){(function(){k.activeKeys={};var n=t.initCaptures(function(n){return{saver:[n.create("save",function(){k.save()},"ctrl-S")]}});angular.extend(k.activeKeys,n.saver)})(),k.canSave=!1,u(),d(),a.on("tokenChange",p),a.on("tokenAdded",p),a.on("tokenRemoved",p)}}]),angular.module("arethusa.core").service("sidepanel",["globalSettings","$rootScope","$timeout",function(n,e,t){function i(n){return angular.element(document.getElementById(n))}function a(){o.width(o.width()+s.width()),s.hide()}function r(){var e=n.layout;l.active=e.sidepanel,l.active&&(l.folded=e.folded,t(function(){o=i("main-body"),s=i("sidepanel"),l.folded&&a()}))}var o,s,l=this;this.toggle=function(){s.width(s.width()),l.folded?(o.width(o.width()-s.width()),s.show()):a(),l.folded=!l.folded},this.activeKeys={},e.$on("layoutChange",r),r()}]),angular.module("arethusa.core").service("spinner",function(){var n=this;this.spinning=0,this.spin=function(){n.spinning++},this.stop=function(){n.spinning--}}),angular.module("arethusa.core").service("state",["configurator","navigator","$rootScope","documentStore","keyCapture","locator","StateChange","idHandler","globalSettings","confirmationDialog","notifier","logger","DocumentResolver",function(n,e,i,a,r,o,s,l,c,u,d,g,h){function f(n){n?new h(n).resolve(w,p):v()}function p(n){return function(i){e.addSentences(i),function(){var n=m();n&&e.goTo(n)||e.updateId()}(),x=e.currentChunk(),function(n){var e=m();if(e){var i=t.map(n,function(n){return l.padIdWithSId(n,e)});y(i)}}(n.preselections),A(n)}}function m(){var n=S.conf.chunkParam;return n?o.get(n):void 0}function v(){return e.reset(),S.deselectAll(),0===Object.keys(w).length?void S.checkLoadStatus():void angular.forEach(w,function(n,e){n.get(p(n))})}function y(n){angular.forEach(n,function(n,e){S.selectToken(n,"ctrl-click")})}function k(n){var e,t=S.firstSelected(),i=Object.keys(S.tokens),a=i.indexOf(t);switch(n){case"next":e=i[a+1]||i[0];break;case"prev":e=i[a-1]||i[i.length-1]}S.deselectAll(),S.selectToken(e,"click")}function b(n){n.status||(n.status={})}var w,S=this;this.documents=function(){return a.store};var x={};this.retrieveDocuments=f,this.retrieveTokens=v;var C,A=function(n){n.loaded=!0,S.checkLoadStatus()};this.checkLoadStatus=function(){var e=!0;if(angular.forEach(w,function(n,t){e=e&&n.loaded}),e){var t=function(){S.launched=!0,S.replaceState(x,!0)};a.hasAdditionalConfs()?n.loadAdditionalConf(a.confs).finally(t):t()}},this.asString=function(n){return(S.getToken(n)||{}).string},this.getToken=function(n){return S.tokens[n]||{}},this.selectedTokens={},this.clickedTokens={},this.hasSelections=function(){return 0!==Object.keys(S.selectedTokens).length},this.hasClickSelections=function(){return Object.keys(S.clickedTokens).length},this.isSelected=function(n){return n in this.selectedTokens},this.isClicked=function(n){return n in this.clickedTokens},this.multiSelect=function(n){S.deselectAll(),y(n)},this.selectToken=function(n,e){"click"===e&&S.deselectAll(),function(n,e){return"hover"===n&&"hover"!==e||!n}(S.selectionType(n),e)&&(S.selectedTokens[n]=e,"hover"!==e&&(S.clickedTokens[n]=e),"click"===e&&(C=function(){S.selectedTokens[n]=S.clickedTokens[n]="ctrl-click"}),"ctrl-click"===e&&C&&(C(),C=void 0))},this.selectionType=function(n){return S.selectedTokens[n]},this.deselectToken=function(n,e){S.selectionType(n)===e&&(delete S.selectedTokens[n],delete S.clickedTokens[n])},this.toggleSelection=function(n,e){this.isSelected(n)&&this.selectionType(n)==e?this.deselectToken(n,e):this.selectToken(n,e)},this.deselectAll=function(){for(var n in C=void 0,S.selectedTokens)delete S.selectedTokens[n],delete S.clickedTokens[n]},this.firstSelected=function(){return Object.keys(S.selectedTokens)[0]},this.selectNextToken=function(){k("next")},this.selectPrevToken=function(){k("prev")},this.toTokenStrings=function(n){var e=l.nonSequentialIds(n),t=[];return angular.forEach(n,function(n,i){t.push(S.asString(n)),e[i]&&t.push("...")}),t.join(" ")},this.addToken=function(n,t){S.tokens[t]=n,b(n),e.addToken(n),S.countTotalTokens(),S.broadcast("tokenAdded",n)},this.removeToken=function(n){var t=S.getToken(n),i="Do you really want to remove "+t.string+"?";u.ask(i).then(function(){S.doBatched(function(){S.broadcast("tokenRemoved",t),delete S.tokens[n]}),e.removeToken(t),l.unassignSourceId(t),d.success(t.string+" removed!"),S.deselectAll(),S.countTotalTokens()})},this.countTotalTokens=function(){S.totalTokens=Object.keys(S.tokens).length},this.countTokens=function(n){var e=0;return angular.forEach(S.tokens,function(t,i){n(t)&&e++}),e},this.setState=function(n,e,t){g.log("state.setState is DEPRECATED. Use state.change() instead.");var i=S.tokens[n];i&&(i[e],i[e]=t)},this.unsetState=function(n,e){var t=S.tokens[n];t[e],delete t[e]},this.replaceState=function(n,e){e||S.deselectAll(),S.tokens=n,S.launched&&S.broadcast("stateLoaded")},this.setStyle=function(n,e){S.getToken(n).style=e},this.unsetStyle=function(n){S.getToken(n).style={}},this.addStyle=function(n,e){var t=S.getToken(n);t.style||(t.style={}),angular.extend(t.style,e)},this.removeStyle=function(n,e){var i=S.getToken(n).style;if(i){var a=t.toAry(e);angular.forEach(a,function(n,e){delete i[n]})}},this.unapplyStylings=function(){angular.forEach(S.tokens,function(n,e){S.unsetStyle(e)})},this.addStatusObjects=function(){angular.forEach(S.tokens,b)},this.lazyChange=function(n,e,t,i,a){return new s(S,n,e,t,i,a)},this.change=function(n,e,t,i,a){var r=S.lazyChange(n,e,t,i,a);return c.shouldDeselect(e)&&S.deselectAll(),r.exec()};var T={"*":[]};this.notifyWatchers=function(n){function e(e){e.exec(n.newVal,n.oldVal,n)}var t=T[n.property]||[];angular.forEach(t,e),angular.forEach(T["*"],e)},this.watch=function(n,e,t){var i=T[n];i||(i=T[n]=[]);var a=new function(n,e,t,i){var a=this;this.event=n,this.exec=e,this.destroy=function(){t&&t(),i.splice(i.indexOf(a),1)}}(n,e,t,i);return i.push(a),a.destroy},this.on=function(n,e){i.$on(n,e)},this.broadcast=function(n,e){i.$broadcast(n,e)},this.doSilent=function(n){S.silent=!0,n(),S.silent=!1},this.doBatched=function(n){S.batchChangeStart(),n(),S.batchChangeStop()},this.batchChangeStart=function(){S.batchChange=!0},this.batchChangeStop=function(){S.batchChange=!1,S.broadcast("batchChangeStop")},this.initServices=function(){e.init(),c.init()},this.init=function(){(function(){S.conf=n.configurationFor("main"),w=n.getRetrievers(S.conf.retrievers),S.silent=!0,S.batchChange=!1,S.debug=S.conf.debug,S.initServices(),S.activeKeys={};var e=r.initCaptures(function(n){return{selections:[n.create("nextToken",function(){n.doRepeated(S.selectNextToken)},"w"),n.create("prevToken",function(){n.doRepeated(S.selectPrevToken)},"e"),n.create("deselect",S.deselectAll,"esc"),n.create("deselect-alternative",S.deselectAll,"↵")]}});angular.extend(S.activeKeys,e.selections)})(),f(S.conf.resolver)},this.postInit=function(){S.addStatusObjects(),S.countTotalTokens()}}]),angular.module("arethusa.core").service("userPreferences",["globalSettings","arethusaLocalStorage",function(n,e){function t(n){return a+"."+n}function i(n,i,a){e.set(t(n+"."+i),a)}var a="preferences";this.set=function(e,t,a){n.persistSettings&&i(e,t,a)},this.get=function(n,i){return e.get(t(n+"."+i))}}]),angular.module("arethusa.core").service("versioner",["VERSION",function(n){function e(n){return t.repository+"/tree/"+n}var t=this;angular.extend(this,n),this.commitUrl=e(n.revision),this.branchUrl=e(n.branch)}]),angular.module("arethusa.core").value("duScrollEasing",function(n){return.5>n?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1}),angular.module("arethusa.core").constant("LOCALES",["en","de","fr","hr","pt_BR","ka","bg"]),angular.module("arethusa.core").run(["$templateCache",function(n){"use strict";n.put("js/arethusa.core/templates/arethusa_grid.html",'<div gridster="grid.options">\n  <ul>\n    <li\n      gridster-item="item"\n      ng-style="item.style"\n      ng-repeat="item in grid.items track by item.plugin">\n      <arethusa-grid-handle>Handle</arethusa-grid-handle>\n      <plugin name="{{ item.plugin }}"></plugin>\n    </li>\n  </ul>\n</div>\n'),n.put("js/arethusa.core/templates/arethusa_grid_handle.html",'<div class="drag-handle-trigger">\n  <div class="drag-handle fade" ng-show="visible">\n    <div class="drag-handle">\n      <span>{{ item.plugin }}</span>\n      <span ng-show="plugin.settings" settings-trigger="right"/>\n      <div ng-if="settingsOn"\n        style="padding: .3rem 1rem; text-align: right"\n        class="fade">\n        <div\n          ng-repeat="setting in plugin.settings">\n          <div ng-if="setting.directive" dynamic-directive="{{ setting.directive }}"/>\n          <div ng-if="!setting.directive" plugin-setting/>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n'),n.put("js/arethusa.core/templates/arethusa_tabs.html",'<tabset class="arethusa-tabs">\n  <tab\n    ng-repeat="pl in visibleTabs"\n    select="plugins.setActive(pl)"\n    heading="{{ pl.displayName }}"\n    active="plugins.isSelected(pl)">\n    <plugin\n      name="{{ pl.name }}"\n      with-settings="true"\n      ng-if="plugins.isActive(pl)">\n    </plugin>\n  </tab>\n  <tab ng-if="showSettingsTab">\n    <tab-heading>\n      <i class="fi-widget rotate-on-hover"></i>\n    </tab-heading>\n\n    <div class="arethusa-tabs-settings-tab">\n      <p translate="tabs.helpText"></p>\n\n      <ul dnd-list="list">\n        <li ng-repeat="item in list"\n          dnd-draggable="item"\n          dnd-moved="moveTab($index, event)"\n          dnd-effect-allowed="move"\n          dnd-selected="toggleTab(item)"\n          ng-class="{ deactivated: !isActive(item) }">\n          {{ item.label }}\n        </li>\n      </ul>\n    </div>\n  </tab>\n</tabset>\n\n'),n.put("js/arethusa.core/templates/arethusa_user.html",'<span>\n  <a ng-href="{{ user.page }}" target="_blank">{{ name }}</a>\n</span>\n<span ng-if="withMail && user.mail" style="margin-left: .5rem">\n  <a ng-href="mailto:{{ user.mail }}">\n    <i class="fi-mail"></i>\n  </a>\n</span>\n'),n.put("js/arethusa.core/templates/chunk_mode_switcher.html",'<div>\n  <label>\n    <span translate="globalSettings.chunkMode"/>\n    <select\n      style="width: 8rem"\n      class="compact"\n      ng-model="navi.chunkMode"\n      ng-change="navi.applyChunkMode()"\n      ng-options="mode as mode for mode in navi.chunkModes">\n    </select>\n\n    <form ng-submit="tryToSetChunkSize()" style="display: inline-block">\n      <input\n        style="width: 2rem"\n        class="compact"\n        type="text" ng-model="size"/>\n    </form>\n  </label>\n</div>\n\n'),n.put("js/arethusa.core/templates/collected_plugin_settings.html",'<table class="plugin-settings">\n  <tr ng-repeat="plugin in plugins.all" ng-if="plugin.settings">\n    <td class="name">{{ plugin.displayName }}</td>\n    <td ng-repeat="setting in plugin.settings">\n      <span ng-if="setting.directive" dynamic-directive="{{ setting.directive }}"/>\n      <span ng-if="!setting.directive" plugin-setting/>\n    </td>\n  </tr>\n</table>\n'),n.put("js/arethusa.core/templates/colorizer_setting.html",'<label>\n  <span translate="{{ setting.label }}"/>\n  <select\n    style="width: 8rem"\n    class="compact"\n    ng-model="gS[setting.property]"\n    ng-change="gS.applyColorizer()"\n    ng-options="k as k for (k, v) in gS.colorizers">\n  </select>\n</label>\n'),n.put("js/arethusa.core/templates/confirmation_dialog.html",'<div class="center">\n  <p class="italic bold ">\n    {{ message }}\n  </p>\n  <div>\n    <span\n      ng-click="$close()"\n      class="button success success"\n      close-on-enter\n      translate="yes">\n    </span>\n    <span\n      ng-click="$dismiss()"\n      class="button success alert"\n      translate="no">\n    </span>\n  </div>\n</div>\n\n'),n.put("js/arethusa.core/templates/editors.html",'<ul ng-if="editors.editorsPresent" class="no-list">\n  <li ng-repeat="(doc, users) in editors.perDocument">\n     <strong>{{ doc }}</strong>\n     <ul class="no-list">\n       <li ng-repeat="user in users">\n          <div arethusa-user="user" with-mail="true"/>\n       </li>\n     </ul>\n  </li>\n</ul>\n\n<div ng-if="!editors.editorsPresent" translate="editors.noEditorsPresent"/>\n'),n.put("js/arethusa.core/templates/error_dialog.html",'<div class="center">\n  <p class="italic bold ">\n    {{ message }}\n  </p>\n  <p class="error-modal-sendhint" translate="errorDialog.sendHint"/>\n  <pre class="overflow-wrap-word">\n    {{ trace }}\n  </pre>\n  <div uservoice-embed target="error-uv-embedded" class="error-modal">\n    <div class="error-uv-embedded"></div>\n  </div>\n  <div class="center">\n    <span\n      ng-click="$dismiss()"\n      class="button success alert"\n      translate="errorDialog.close">\n    </span>\n  </div>\n</div>\n\n'),n.put("js/arethusa.core/templates/foreign_keys_help.html",'<div ng-if="visible">\n  <ul id="keyboard">\n    <li ng-repeat="key in keys"\n      id="{{ key.lower }}"\n      ng-click="generate(key.lower)"\n      ng-class="key.style.class"\n      class="keyboard-key">\n      <span ng-repeat="char in key.show"\n        class="shifted-{{$index}}"\n        ng-class="key.style.class[{{$index}}]">{{ char }}</span>\n    </li>\n  </ul>\n  <div delimiter/>\n</div>\n'),n.put("js/arethusa.core/templates/global_click_action.html",'<label>\n  <span translate="{{ setting.label }}"/>\n  <select\n    style="width: 8rem"\n    class="compact"\n    ng-model="gS[setting.property]"\n    ng-change="gS.setClickAction(gS[setting.property])"\n    ng-options="k as k for (k, v) in gS.clickActions">\n  </select>\n</label>\n'),n.put("js/arethusa.core/templates/global_settings_panel.html",'<div ng-if="active" class="fade">\n  <p class="text" translate="globalSettings.title"/>\n  <div class="small-12 columns scrollable text">\n    <ul class="no-list in-columns" style="height: 240px">\n      <li\n        class="fade"\n        ng-repeat="name in gS.settings | keys"\n        ng-init="setting = gS.settings[name]">\n        <div ng-switch="setting.type">\n          <div\n            ng-switch-when="custom"\n            dynamic-directive="{{ setting.directive }}"/>\n          <div ng-switch-default>\n            <input\n              type="{{ setting.type }}"\n              ng-change="gS.propagateSetting(setting.property)"\n              ng-model="gS[setting.property]"/>\n            <label>\n              <span translate="{{ setting.label }}"/>\n            </label>\n          </div>\n        </div>\n      </li>\n    </ul>\n\n    <div\n      ng-click="togglePluginSettings()"\n      translate="globalSettings.pluginSettings"\n      class="underline clickable">\n    </div>\n\n    <div\n      class="fade"\n      ng-if="pluginSettingsVisible"\n      collected-plugin-settings>\n    </div>\n  </div>\n</div>\n'),n.put("js/arethusa.core/templates/grid_items.html",'<br/>\n<div>\n  <p class="text">\n    <span>Grid</span>\n    <span translate="items"></span>\n  </p>\n  <ul class="no-list in-columns">\n    <li ng-repeat="(name, status) in grid.itemList">\n      <input\n        style="margin-bottom: 0.3rem"\n        type="checkbox"\n        ng-change="grid.toggleItem(name)"\n        ng-model="grid.itemList[name]"/>\n      <label>\n        {{ name }}\n      </label>\n    </li>\n  </ul>\n</div>\n'),n.put("js/arethusa.core/templates/grid_setting.html",'<div style="display: inline-block">\n  <p class="text">\n    <span>Grid</span>\n    <span translate="settings"></span>\n  </p>\n  <ul class="no-list">\n    <li ng-repeat="(key, value) in settings">\n      <input\n        type="checkbox"\n        ng-model="settings[key]"/>\n      <label>\n        <span translate="grid.{{ key }}"/>\n      </label>\n    </li>\n  </ul>\n</div>\n'),n.put("js/arethusa.core/templates/help_panel.html",'<div ng-if="active" class="fade small-12-columns">\n  <div class="small-6 large-6 columns">\n    <div help-panel-item toggler="colors" heading="helpPanel.colorLegends" height="400px">\n      <ul class="no-list" ng-repeat="(name, values) in gS.colorMaps()">\n        <li\n          ng-class="{ \'active-colorizer\': name === gS.colorizer }">\n          {{ name }}\n        </li>\n        <ul class="no-list" ng-repeat="map in values.maps">\n          <li>\n            {{ map.label }}\n            <table class="small">\n              <tr>\n                <th ng-repeat="header in values.header">\n                  <strong>{{ header }}</strong>\n                </th>\n              </tr>\n              <tr ng-repeat="(k, col) in map.colors">\n                <td\n                  ng-style="col"\n                  ng-repeat="val in k.split(\' || \') track by $index">\n                  {{ val }}\n                </td>\n              </tr>\n            </table>\n          </li>\n        </ul>\n      </ul>\n    </div>\n\n    <div help-panel-item toggler="messages" heading="messages" height="200px">\n      <ul class="no-list">\n        <li ng-repeat="message in notifier.messages">\n          <div class="notification-list-item">\n            <span class="time">{{ message.time | date: "HH:mm:ss" }}</span>\n            <span class="message toast-{{ message.type }}">{{ message.message }}</span>\n          </div>\n        </li>\n      </ul>\n    </div>\n\n    <div help-panel-item toggler="editors" heading="editors.title" height="200px">\n      <div editors/>\n    </div>\n  </div>\n\n  <div class="small-6 large-6 columns">\n    <div help-panel-item toggler="keys" heading="helpPanel.keyboardShortcuts" height="400px">\n      <ul class="no-list" ng-repeat="(section, keys) in kC.activeKeys">\n        <li>{{ section }}</li>\n        <table class="small">\n          <tr ng-repeat="(name, key) in keys">\n            <td><strong>{{ key }}</strong></td><td>{{ name}}</td>\n          </tr>\n        </table>\n      </ul>\n    </div>\n\n    <div help-panel-item toggler="tools" heading="helpPanel.tools" height="50px">\n      <ul class="no-list">\n        <li ng-repeat="tool in tools">\n          <a ng-href="{{ tool.href }}">{{ tool.label }}</a>\n        </li>\n      </ul>\n    </div>\n\n    <div help-panel-item toggler="about" heading="helpPanel.about" height="160px">\n      <ul class="no-list">\n        <li>\n          <table class="small">\n            <tr>\n              <td translate="helpPanel.revision"/>\n              <td>\n                <a ng-href="{{ vers.commitUrl }}" target="_blank">\n                  {{ vers.revision }}\n                </a>\n              </td>\n            <tr>\n            <tr>\n              \x3c!--This is untranslated on purpose!--\x3e\n              <td>Branch</td>\n              <td>\n                <a ng-href="{{ vers.branchUrl }}" target="_blank">\n                  {{ vers.branch }}\n                </a>\n              </td>\n            <tr>\n            <tr>\n              <td translate="date"/>\n              <td>{{ vers.date | date: \'medium\' }}</td>\n            </tr>\n            <tr>\n              <td translate="relocateHandler.title"/>\n              <td relocate/>\n            </tr>\n          </table>\n        </li>\n      </ul>\n    </div>\n  </div>\n</div>\n'),n.put("js/arethusa.core/templates/help_panel_item.html",'<div delimiter/>\n<div class="text">\n  <div help-panel-heading toggler="{{ toggler }}" heading="{{ heading }}"/>\n  <div\n    class="small-12 columns scrollable slider"\n    style="height: {{ height }}"\n    ng-if="visible[toggler]"\n    ng-transclude>\n  </div>\n</div>\n'),n.put("js/arethusa.core/templates/keys_to_screen.html",'<div id="keys-to-screen">\n  <span\n    ng-repeat="key in keys"\n    class="key-to-screen"\n    ng-class="{ joiner: key.joiner }">{{ key.str }}</span>\n  <span ng-repeat="action in actions"\n    class="text italic right action">\n      {{ action.str }}\n  </span>\n</div>\n'),n.put("js/arethusa.core/templates/layout_setting.html",'<label>\n  <span translate="{{ setting.label }}"/>\n  <select\n    style="width: 8rem"\n    class="compact"\n    ng-model="gS[setting.property]"\n    ng-change="gS.broadcastLayoutChange()"\n    ng-options="layout.name for layout in gS.layouts">\n  </select>\n</label>\n'),n.put("js/arethusa.core/templates/navbar_buttons.html",'<li><a class="button" saver/></li>\n<li><a class="button" outputter/></li>\n<li><a class="button" hist-undo/></li>\n<li><a class="button" hist-redo/></li>\n<li><a class="button" sidepanel-folder/></li>\n<li><a class="button" uservoice-trigger/></li>\n<li><a class="button" global-settings-trigger/></li>\n<li><a class="button" help-trigger/></li>\n<li><a class="button" translate-language/></li>\n<li><a class="button" exit/></li>\n\n'),n.put("js/arethusa.core/templates/navbar_buttons_collapsed.html",'<li><a class="button" saver/></li>\n<li><a class="button" hist-undo/></li>\n<li><a class="button" hist-redo/></li>\n<li>\n  <a\n    class="button"\n    title="{{ menuTitle }}"\n    dropdown-toggle="#navbar_collapsed_buttons_menu">\n    <i class="fi-align-justify"></i>\n  </a>\n  <ul id="navbar_collapsed_buttons_menu" class="navbar-dropdown">\n    <li><a outputter/></li>\n    <li><a sidepanel-folder/></li>\n    <li><a uservoice-trigger/></li>\n    <li><a help-trigger/></li>\n    <li><a global-settings-trigger/></li>\n    <li><a translate-language/></li>\n    <li><a exit/></li>\n  </ul>\n</li>\n'),n.put("js/arethusa.core/templates/navbar_navigation.html",'<ul ng-show="showNavigation()" class="navbar-navigation">\n  <li>\n    <a>{{ navStat.citation }}</a>\n  </li>\n  \x3c!--The wrapping divs around the a elements are only there for styling - the--\x3e\n  \x3c!--foundation topbar gives them a differnet look and feel when they are wrapped.--\x3e\n  <li>\n    <div>\n      <a\n        class="nav-link"\n        title="{{ trsls.goToFirst() }}"\n        ng-click="goToFirst()"\n        ng-class="{ disabled: !navStat.hasPrev }">\n        <i class="fi-previous"></i>\n      </a>\n    </div>\n  </li>\n  <li>\n  <div>\n    <a\n      class="nav-link"\n      title="{{ trsls.goToPrev(keys) }}"\n      ng-click="prev()"\n      ng-class="{ disabled: !navStat.hasPrev }">\n      <i class="fi-arrow-left"></i>\n    </a>\n  </div>\n  </li>\n  <li>\n    <div>\n      <ul class="navigation">\n        <li>\n          <a>\n            {{ ids }}\n          </a>\n          <ul>\n            <div class="navigation-menu small-12 large-12 columns">\n              <div>\n                <form ng-submit="goTo(goToLocation)">\n                  <input class="inline" type="text" ng-model="goToLocation"/>\n                </form>\n              </div>\n              <div>\n                <a sentence-list translate="list"\n                  title="{{ trsls.list(keys) }}"/>\n              </div>\n            </div>\n          </ul>\n        </li>\n      </ul>\n    </div>\n  </li>\n  <li>\n    <div>\n      <a\n        class="nav-link"\n        title="{{ trsls.goToNext(keys) }}"\n        ng-click="next()"\n        ng-class="{ disabled: !navStat.hasNext }">\n        <i class="fi-arrow-right"></i>\n    </a>\n  </div>\n  </li>\n  <li>\n    <div>\n      <a\n        class="nav-link"\n        title="{{ trsls.goToLast() }}"\n        ng-click="goToLast()"\n        ng-class="{ disabled: !navStat.hasNext }">\n        <i class="fi-next"></i>\n      </a>\n    </div>\n  </li>\n</ul>\n'),n.put("js/arethusa.core/templates/navbar_notifier.html",'<ul ng-show="showNotifier()">\n  <span current-message/>\n</ul>\n\n'),n.put("js/arethusa.core/templates/navbar_search.html",'<ul ng-show="showSearch()">\n  <li class="has-form">\n    <div class="row collapse">\n      <div class="large-10 small-10 columns">\n        <form ng-submit="search()">\n          <input\n            type="text"\n            ng-model="query"\n            placeholder="{{ search_documents }}...">\n        </form>\n      </div>\n      <div class="large-2 small-2 columns">\n        <button class="alert button expand" ng-click="search()">\n          <i class="fi-magnifying-glass"></i>\n        </button>\n      </div>\n    </div>\n  </li>\n</ul>\n'),n.put("js/arethusa.core/templates/notifications.html","<toaster-container\n  toaster-options=\"{\n    'close-button': true,\n    'position-class': 'toast-bottom-right'\n  }\">\n</toaster-container>\n"),n.put("js/arethusa.core/templates/outputter.html",'<div class="outputter">\n  <div outputter-item ng-repeat="(name, obj) in saver.outputters"/>\n</div>\n'),n.put("js/arethusa.core/templates/outputter_item.html",'<div>\n  <span class="italic">{{ obj.identifier }}</span>\n  <span class="buttons">\n    <span\n      class="button radius micro"\n      ng-class="{ on: preview }"\n      ng-click="togglePreview()"\n      translate="preview">\n    </span>\n    <span\n      class="button radius micro"\n      ng-click="download()"\n      translate="download">\n    </span>\n  </span>\n</div>\n<div delimiter/>\n<div ng-if="preview" hljs class="preview fade" source="data()"/>\n\n'),n.put("js/arethusa.core/templates/plugin.html",'<div\n  id="{{ plugin.name }}"\n  class="fade very-slow">\n  <div ng-if="withSettings && plugin.settings" plugin-settings/>\n  <div ng-include="plugin.template"/>\n</div>\n'),n.put("js/arethusa.core/templates/plugin_setting.html",'<label ng-if="!setting.directive" class="margined-hor-tiny">\n  {{ setting.label }}\n  <input\n    type="checkbox"\n    style="margin: 0"\n    ng-change="change()"\n    ng-model="plugin[setting.model]"/>\n</label>\n'),n.put("js/arethusa.core/templates/plugin_settings.html",'<div class="small-12 columns">\n  <span settings-trigger="right"/>\n  <span ng-show="settingsOn">\n    <span ng-repeat="setting in plugin.settings" class="right">\n      <span ng-if="setting.directive" dynamic-directive="{{ setting.directive }}"/>\n      <span ng-if="!setting.directive" plugin-setting/>\n    </span>\n  </span>\n</div>\n'),n.put("js/arethusa.core/templates/relocate.html",'<ul ng-if="locations" class="no-list">\n  <li class="relocate-item clickable" ng-repeat="location in locations" ng-click="relocate(location)">\n    {{ location }}\n  </li>\n</ul>\n<div ng-if="!locations" translate="relocateHandler.noLocations"/>\n'),n.put("js/arethusa.core/templates/sentence.html",'<div\n  ng-click="goTo(id)">\n  <table class="sentence-list" ng-class="{ changed: sentence.changed }">\n    <tr class="sentence-list">\n      <td>{{ citation }} {{ id }}</td>\n      <td>{{ sentenceString }}</td>\n    </tr>\n  </table>\n</div>\n\n'),n.put("js/arethusa.core/templates/settings_trigger.html",'<span\n  class="clickable"\n  ng-click="settingsOn = !settingsOn">\n  <i class="fi-widget" style="font-size: 1.2rem"></i>\n</span>\n\n'),n.put("js/arethusa.core/templates/token_selector.html",'<dl class="sub-nav" style="display:inline-block">\n  <dt\n    style="color: #4D4D4D"\n    tooltip-popup-delay="700"\\\n    tooltip-placement="bottom"\\\n    tooltip-html-unsafe="{{ selection.tooltip }}">\n    {{ selection.label }}\n  </dt>\n  <dd ng-repeat="selector in selectors" \n      ng-class="{active: selector.isActive}">\n      <a\n        ng-click="selector.action()"\n        ng-class="selector.styleClasses"\n        tooltip-popup-delay="700"\\\n        tooltip-placement="bottom"\\\n        tooltip-html-unsafe="{{ selector.tooltip }}">\n        {{selector.label}}\n      </a>\n  </dd>\n</dl>\n'),n.put("js/arethusa.core/templates/translate_language.html",'<div class="flags {{ lang }}"/>\n')}]),angular.module("arethusa.tools",[]),angular.module("arethusa.tools").controller("MorphToolsCtrl",["$scope","plugins","latinAttrs","greekAttrs","configurator","MORPH_IMPORTS","$http","$injector","$q","fileHandler","_",function(n,e,t,a,r,o,s,l,c,u,d){function g(e){M.plugins.morph=_[e],n.usedLanguage=e}function h(e,t){f();var a=e.split("\n");angular.forEach(a,function(e,t){var a=e.split(","),r=a[0],o={lemma:a[1],postag:a[2]};(function(n,e){var t=c.defer(),i=I[e];return i?t.resolve(i):s.get(e,E).then(function(n){var i=n.data.name;I[e]=i,t.resolve(i)}),t.promise})(0,a[3]).then(function(e){o.origin=e,C.postagToAttributes(o),function(n,e){var t;return A.retriever.getData(n,function(n){t=n}),!t||!i.find(t,function(n){return A.comparator(e,n)})}(r,o)&&(C.addToLocalStorage(a[0],o),n.status.count+=1)})})}function f(){n.status=d.inject(["importForms","exportForms","importFrequency","exportFrequency"],function(n,e){return n[e]={count:null},n},{})}function p(e,t){f();var i=0;u.upload(function(a){d.forEach(a,function(n,t){i+=A[e](t,n)}),t(a,i),n.$digest()})}function m(n,e,t){f();var i=A[e]();u.download(n,JSON.stringify(i,null,2),$),t(i)}function v(n){w("exportForms",S(n))}function y(n,e){w("importForms",S(n),e)}function k(n){w("exportFrequency",x(n))}function b(n,e){w("importFrequency",x(n),e)}function w(e,t,i){n.status[e].count=null!==i?i:t}function S(n){return d.inject(n,function(n,e){return n+e.length},0)}function x(n){return d.inject(n,function(n,e,t){return n+e.split(A.delimiters.preference).length},0)}var C,A,T="arethusa_morph_forms.json",j="arethusa_morph_frequency.json",$="application/json",_={lat:t.data,grc:a.data},E={headers:{Accept:"application/json"}},I={},M=r.configuration;n.loadCsvFile=function(e){n.importStarted=!0,s.get(e.route).then(function(t){g(e.language),h(t.data),n.importStarted=!1})},n.importFile=function(){p("addForms",y)},n.exportFile=function(){m(T,"getForms",v)},n.importFrequencyFile=function(){p("addPreferences",b)},n.exportFrequencyFile=function(){m(j,"getPreferences",k)},g("lat"),e.start(["morph"]).then(function(){C=e.get("morph"),A=l.get("morphLocalStorage"),n.ready=!0})}]),angular.module("arethusa.tools").constant("MORPH_IMPORTS",[{name:"Latin Morphology",language:"lat",route:"..."},{name:"Greek Morphology",language:"grc",route:"..."},{name:"Test Data from Vanessa",language:"grc",route:"http://www.perseids.org/morph/masterlocal.csv"}]),angular.module("arethusa.tools").run(["$templateCache",function(n){"use strict";n.put("js/arethusa.tools/templates/morph_tools.html",'<div class="row">\n  <h3>Arethusa Morph Tools</h3>\n\n  <div class="morph-tools-form-import">\n    <div class="fade" ng-if="ready">\n      <ul>\n        <li ng-repeat="file in files">\n          <a ng-click="loadCsvFile(file)">{{ file.name }}</a>\n        </li>\n      </ul>\n    </div>\n\n    <div>\n      <button class="small rounded" ng-click="importFile()">\n        Import forms from file\n      </button>\n      <button class="small rounded" ng-click="exportFile()">\n        Export forms to file\n      </button>\n    </div>\n\n    <div ng-if="status.importForms.count != null">\n      {{ status.importForms.count}} forms successfully imported!\n    </div>\n\n    <div ng-if="status.exportForms.count">\n      {{ status.exportForms.count}} forms successfully exported!\n    </div>\n\n    <div ng-if="importStarted" style="color: green">\n      Processing import...\n    </div>\n  </div>\n\n  <div class="morph-tools-frequency-import">\n    <div>\n      <button class="small rounded" ng-click="importFrequencyFile()">\n        Import frequency data from file\n      </button>\n      <button class="small rounded" ng-click="exportFrequencyFile()">\n        Export frequency data to file\n      </button>\n    </div>\n\n    <div ng-if="status.importFrequency.count != null">\n      {{ status.importFrequency.count}} forms successfully imported!\n    </div>\n\n    <div ng-if="status.exportFrequency.count">\n      {{ status.exportFrequency.count}} forms successfully exported!\n    </div>\n\n  </div>\n</div>\n')}]),angular.module("arethusa.contextMenu",[]),angular.module("arethusa.contextMenu").directive("arethusaContextMenu",[function(){return{restrict:"AE",scope:{token:"=tokenObj",plugins:"="},link:function(n,e,t){},templateUrl:"js/arethusa.context_menu/templates/arethusa_context_menu.html"}}]),angular.module("arethusa.contextMenu").directive("arethusaContextMenus",[function(){return{restrict:"A",scope:{tokens:"=",plugins:"="},link:function(n,e,t){n.fullId=function(n){return n.sentenceId+n.id}},template:'        <arethusa-context-menu          ng-repeat="(id, token) in tokens track by id"          plugins="plugins"          token-obj="token">        </arethusa-context-menu>      '}}]),angular.module("arethusa.contextMenu").factory("menuElement",function(){return{element:null}}).directive("contextMenu",["$document","$parse","menuElement","keyCapture",function(n,e,t,i){return{restrict:"A",scope:{menuObj:"=",menuTrigger:"@",menuPosition:"@"},link:function(a,r,o){function s(n,e,i){e.addClass("menu-open"),e.css("display","inline-block"),function(n,e){console.log(e);var t=e.offset();console.log(t),"bottom"===a.menuPosition&&(t.top,e.outerHeight(),t.left),"right"===a.menuPosition&&(t.top,t.left,e.outerWidth()),n.css("right","40px"),n.css("top","150px")}(e,i),t.lastTarget=n.target,a.menuObj&&(a.menuObj.status.contextMenuOpen=!0),g=!0}function l(n){n.removeClass("menu-open"),n.css("display","none"),t.lastTarget=void 0,a.menuObj&&(a.menuObj.status.contextMenuOpen=!1),g=!1}function c(){a.$apply(function(){l(t.element)})}function u(n){return n.target===t.lastTarget&&n.button==={rightclick:2,click:1}[a.menuTrigger]}function d(n){if(g){if(function(n){var e=angular.element(n),i=t.element;return e.parents("#"+i.attr("id")).length}(n.target))return;if(u(n))return;c()}}var g=!1,h=e(o.contextMenu),f="rightclick"==a.menuTrigger?"contextmenu":"click"==a.menuTrigger?"click":void 0;r.bind(f,function(n){t.element&&l(t.element),t.element=angular.element(document.getElementById(o.menuId)),n.preventDefault(),n.stopPropagation(),a.$apply(function(){h(a,{$event:n}),s(n,t.element,r)})}),n.on("click",d);var p=i.onKeyPressed("esc",function(){g&&(c(),i.stopPropagation())},1e3);a.$on("$destroy",function(){n.off("click",d),p()})}}}]),angular.module("arethusa.contextMenu").directive("pluginContextMenu",function(){return{restrict:"E",scope:!0,replace:!0,template:'      <div id="{{ plugin.name }}-context-menu"        ng-include="plugin.contextMenuTemplate">      </div>    '}}),angular.module("arethusa.contextMenu").run(["$templateCache",function(n){"use strict";n.put("js/arethusa.context_menu/templates/arethusa_context_menu.html",'<div id="tcm{{ token.id }}" class="token-context-menu">\n  <div ng-if="token.status.contextMenuOpen">\n    <div ng-repeat="plugin in plugins">\n      <plugin-context-menu class="menu-element"></plugin-context-menu>\n    </div>\n  </div>\n</div>\n')}]),angular.module("arethusa.history",[]),angular.module("arethusa.history").directive("histRedo",["generator","history","translator",function(n,e,t){return n.historyTrigger(e,t,"redo","repeat")}]),angular.module("arethusa.history").directive("histUndo",["generator","history","translator",function(n,e,t){return n.historyTrigger(e,t,"undo")}]),angular.module("arethusa.history").directive("historyBatch",function(){return{restrict:"A",scope:{batch:"=historyBatch"},link:function(n,e,t){n.events=n.batch.events},templateUrl:"js/arethusa.history/templates/history_batch.html"}}),angular.module("arethusa.history").directive("historyEvent",["idHandler","$compile",function(n,e){return{restrict:"A",scope:{event:"=historyEvent"},link:function(t,i,a){function r(n){return n&&"object"==typeof n&&(t.blocked=!0),n||"nothing"}t.token=t.event.token,t.id=t.token.id,t.type=t.event.type,t.trslKey={start:"history."+t.type+".start",end:"history."+t.type+".end"},"change"===t.type&&(t.blocked=!1,t.property=t.event.property,t.oldVal=r(t.event.oldVal),t.newVal=r(t.event.newVal)),t.formatId=function(e){return n.formatId(e,"%w")},i.find("#token").append(e('          <span            class="text"            token="token"            colorize="true"            click="true"            hover="true">          </span>        ')(t))},templateUrl:"js/arethusa.history/templates/history_event.html"}}]),angular.module("arethusa.history").directive("historyList",["history","$compile",function(n,e){return{restrict:"A",scope:{},link:function(e,t,i){e.history=n,e.events=n.events,e.$watch("history.position",function(n,t){e.position=n})},templateUrl:"js/arethusa.history/templates/history_list.html"}}]),angular.module("arethusa.history").service("history",["configurator","keyCapture","state","translator","notifier",function(n,e,t,i,a){function r(n){t.doSilent(n),s()}function o(){return u.events[u.position]}function s(){var n=u.events.length>0;u.canUndo=n&&u.position<u.events.length,u.canRedo=n&&u.position>0}function l(n,e){var i=n.id;this.token=n,this.type=e,this.time=new Date,"add"===e?(this.exec=function(){t.addToken(n,i)},this.undo=function(){t.removeToken(i)}):(this.exec=function(){t.removeToken(i)},this.undo=function(){t.addToken(n,i)})}function c(){function n(){angular.forEach(i.events,function(n,e){n.exec()})}function e(){angular.forEach(i.events,function(n,e){n.undo()})}var i=this;this.events=[],this.type="batch",this.push=function(n){i.events.push(n)},this.count=function(){return i.events.length},this.pop=function(){return i.events.pop()},this.exec=function(){t.doBatched(n)},this.undo=function(){t.doBatched(e)}}var u=this;this.name="history";var d=i({"history.undoSuccess":"undoSuccess","history.redoSuccess":"redoSuccess"});this.undo=function(){u.canUndo&&(r(function(){o().undo(),u.position++}),a.success(d.undoSuccess()))},this.redo=function(){u.canRedo&&(r(function(){u.position--,o().exec()}),a.success(d.redoSuccess()))};var g=new c;this.saveEvent=function(n){if(!t.silent){if(t.batchChange)return void g.push(n);var e=u.events;e.length===u.maxSize&&e.pop(),e.splice(0,u.position),u.position=0,e.unshift(n),s()}},t.watch("*",function(n,e,t){u.saveEvent(t)}),t.on("tokenAdded",function(n,e){var t=new l(e,"add");u.saveEvent(t)}),t.on("tokenRemoved",function(n,e){var t=new l(e,"remove");u.saveEvent(t)}),t.on("batchChangeStop",function(){if(!t.silent){var n=1===g.count()?g.pop():g;u.saveEvent(n),g=new c}});var h=e.initCaptures(function(n){return{history:[n.create("undo",u.undo,":"),n.create("redo",u.redo,"'")]}});u.activeKeys=angular.extend({},h.history),this.init=function(){n.getConfAndDelegate(u),u.maxSize=u.maxSize||50,u.canRedo=!1,u.canUndo=!1,u.events=[],u.position=0}}]),angular.module("arethusa.history").run(["$templateCache",function(n){"use strict";n.put("js/arethusa.history/templates/history_batch.html",'<span ng-repeat="e in events" history-event="e"/>\n'),n.put("js/arethusa.history/templates/history_event.html",'<div>\n  <span\n    translate="{{ trslKey.start }}"\n    translate-value-property="{{ property }}">\n  </span>\n  <span id="token"/>\n  <sup class="note"> {{ formatId(id) }} </sup>\n  <span\n    translate="{{ trslKey.end }}"\n    translate-value-property="{{ property }}">\n  </span>\n  <span ng-if="type === \'change\' && !blocked">\n    <span\n      translate="history.fromTo"\n      translate-value-from="{{ oldVal }}"\n      translate-value-to="{{ newVal }}">\n    </span>\n  </span>\n</div>\n'),n.put("js/arethusa.history/templates/history_list.html",'<div class="small-12 columns">\n  <ol reversed>\n    <p ng-if="events.length === 0" class="text">\n      <span translate="history.noRecords"/>\n    </p>\n    <li\n      ng-repeat="e in events"\n      ng-class="{ \'current-hist-event\': $index === position }"\n      class="text hist-event">\n      <span ng-switch="e.type" >\n        <span ng-switch-when="batch" history-batch="e"/>\n        <span ng-switch-default history-event="e"/>\n      </span>\n    </li>\n  </ol>\n</div>\n')}]),angular.module("arethusa",["angulartics","angulartics.google.analytics","ngRoute","arethusa.core","arethusa.contextMenu","arethusa.history","arethusa.tools"]),angular.module("arethusa").constant("_",window._),angular.module("arethusa").config(["$translateProvider","localStorageServiceProvider","LOCALES",function(n,e,t){for(var i={},a=t.length-1;a>=0;a--){var r=t[a];i[r+"_*"]=r}n.useStaticFilesLoader({prefix:window.i18npath,suffix:".json"}).registerAvailableLanguageKeys(t,i).determinePreferredLanguage().fallbackLanguage("en").addInterpolation("translatorNullInterpolator"),e.setPrefix("arethusa")}]),angular.module("arethusa").value("CONF_PATH","/configs"),angular.module("arethusa").factory("ConstituentTreebankRetriever",["configurator","documentStore","retrieverHelper","idHandler","globalStore","commons",function(n,e,a,r,o,s){function l(n,e){h=0,o.constituents||(o.constituents={});var t=new g,a=function(n,e,t){return i.toAry(n).map(function(n){return c(n,e,t)})}(n.book.sentence,t,e);return angular.extend(o.constituents,t.container),a}function c(n,e,t){var i=n._ID,r=h+=1,o=new g,l=n.wg;l._role="sent",u(l,t,r,e,o);var c=s.sentence(o.container),d=Object.keys(c.tokens).sort();return c.tokens[d[d.length-1]].terminator=!0,a.generateId(c,r,i,t),c}function u(n,e,t,a,r,o){var l=n._nodeId,c=s.constituent(n._class,n._role,l,t,o);a.add(c),angular.forEach(i.toAry(n.wg),function(n,i){u(n,e,t,a,r,l)}),angular.forEach(i.toAry(n.w),function(n,i){d(n,e,t,r,l)})}function d(n,e,t,i,o){var l=s.token(n.__text,t),c=n._morphId,u=r.getId(function(n){return n.substr(n.length-3)}(c),t);a.generateId(l,u,c,e),function(n,e){var t,i,a,r={};for(t in f)i=f[t]||t,(a=e["_"+t])&&(r[i]=a);n.morphology={lemma:e._lemma,attributes:r}}(l,n),function(n,e,t){n.constituency={parent:t,role:e._role}}(l,n,o),i.add(l)}function g(){var n=this;this.container={},this.add=function(e){n.container[e.id]=e}}var h,f={class:"pos",person:"pers",number:"num",tense:null,mood:null,voice:null,gender:"gend",case:null,degree:null};return function(i){var a=this,r=n.provideResource(i.resource),o=i.docIdentifier;this.parse=function(n,i){var a=t.xml2json(n);e.addDocument(o,s.doc(n,a)),i(l(a,o))},this.get=function(n){r.get().then(function(e){e.data,a.parse(e.data,n)})}}}]),angular.module("arethusa").factory("GlobalErrorHandler",["$window","$analytics",function(n,e){var t=n.onerror;n.onerror=function(n,i,a){var r=printStackTrace();return e.eventTrack(n+" @"+i+" : "+a,{category:"error",label:r.join(", ")}),!!t&&t(n,i,a)}}]),angular.module("arethusa").factory("$exceptionHandler",["$analytics","$log",function(n,e){return function(t,i){e.error.apply(e,arguments);var a=printStackTrace();n.eventTrack(t+": "+i,{category:"error",label:a.join(", ")})}}]),angular.module("arethusa").factory("HebrewPersister",["documentStore","configurator","navigator","idHandler",function(n,e,t,i){return function(t){function i(){return n.store[r]}var a=e.provideResource(t.resource),r=t.docIdentifier;this.saveData=function(n,e){a.save(i().xml,"text/xml").then(n,e)}}}]),angular.module("arethusa").factory("HebrewRetriever",["documentStore","configurator","idHandler","languageSettings","hebrewMorph",function(n,e,i,a,r){return function(o){function s(n,e){var t=/^ref\.(\d+\.){3}(\d+)\.(\d+)$/.exec(n),a=i.getId(t[2])+"-"+i.getId(t[3]),r=n,o=new i.Map;return o.add(u,a,r,e),{map:o,id:a}}function l(n,e){var i=t.toAry(n.corpus.article.paragraph);return t.map(i,function(n){var e=n._id,i=function(n){var e={};return angular.forEach(t.toAry(n.sentence),function(n,i){var a=t.toAry(n.token),o=a.length-1;angular.forEach(a,function(t,i){var a=s(t._id,n._id),l=t._surface,c=i===o,u=a.id,d=new function(n,e,t,i){this.id=n,this.string=e,this.idMap=t,this.terminator=i}(u,l,a.map,c);r.parse(t,d),e[u]=d})}),e}(n);return{id:e,tokens:i}})}var c=e.provideResource(o.resource),u=o.docIdentifier;this.getData=function(e){a.setFor(u,"heb"),c.get().then(function(i){var a=i.data,r=t.xml2json(i.data);n.addDocument(u,{json:r,xml:a}),e(l(r))})}}}]),angular.module("arethusa").factory("PhaidraTreebankRetriever",["configurator","documentStore","retrieverHelper","idHandler","languageSettings","locator","commons",function(n,e,t,i,a,r,o){function s(n,e){for(var a="1",r={},s=n.words,c=0;c<s.length;c++){var u=s[c],d=o.token(u.value,a),g=i.getId(u.tbwid,a);t.generateId(d,g,u.CTS,e);var h=u.head;angular.isDefined(h)&&(d.head={id:i.getId(h,a)});var f=u.relation;f&&(d.relation={label:f}),d.morphology={lemma:u.lemma,attributes:l(u)},r[d.id]=d}var p=o.sentence(r,n.CTS);return t.generateId(p,a,a,e),[p]}function l(n){var e,t,i,a={};for(e in c)t=c[e]||e,(i=n[e])&&(a[t]=i);return a}var c={pos:null,person:"pers",number:"num",tense:null,mood:null,voice:null,gender:"gend",case:null,degree:null};return function(i){var r=n.provideResource(i.resource),l=i.docIdentifier;this.preselections=t.getPreselections(i),this.get=function(n){r.get().then(function(t){var i=t.data;e.addDocument(l,o.doc(null,i,null)),a.setFor(l,function(n){return n.words[0].lang}(i)),n(s(i,l))})}}}]),angular.module("arethusa").factory("TreebankPersister",["documentStore","configurator","navigator","idHandler",function(n,e,a,r){return function(o){function s(n,e,i){var a=e.head;a&&a.id?n._head=i[a.id]||0:angular.isDefined(n._head)&&(n._head="");var r=e.relation;r?n._relation=r.label:n._relation&&(n._relation="");var o=e.morphology;o?(angular.isDefined(o.lemma)&&(n._lemma=o.lemma),angular.isDefined(o.postag)&&(n._postag=o.postag),angular.isDefined(o.gloss)&&(n._gloss=o.gloss)):(n._lemma||n._postag)&&(n._lemma=n._postag="");var s=e.sg;s?n._sg=t.map(s.ancestors,function(n){return n.short}).join(" "):n._sg&&(n._sg=""),e.comment&&(n._comment=e.comment),n._form=e.string}function l(){return++d}function c(){var n=t.toAry(u().json.treebank.sentence),e=a.sentencesById;angular.forEach(n,function(n,i){!function(n,e){var i=n[e._id];if(i.changed){var a=t.toAry(e.word);d=a[a.length-1]._id;var o=r.transformToSourceIds(i.tokens,f,l),c=o.mapped,u=o.fullMap,g=[];angular.forEach(a,function(n,e){var t=c[n._id];t?s(n,t,u):g.unshift(e)}),angular.forEach(g,function(n,e){a.splice(n,1)}),angular.forEach(o.unmapped,function(n,e){var t=n.id,i=new function(n,e,t){this._id=n,this._insertion_id=e.split("-")[1],this._artificial=t||"elliptic"}(n.idMap.sourceId(f),t);s(i,n,u),a.push(i)}),i.changed=!1}}(e,n)})}function u(){return n.store[f]}var d,g=this,h=e.provideResource(o.resource),f=o.docIdentifier;this.output=function(n){c(),u().xml=t.json2xml(u().json);var e=u().xml;return n?e:i.formatXml(e)},this.saveData=function(n,e){h.save(g.output(!0),g.mimeType).then(n,e)},this.identifier=f,this.mimeType="text/xml",this.fileType="xml"}}]),angular.module("arethusa").factory("TreebankRetriever",["configurator","documentStore","retrieverHelper","idHandler","commons","editors",function(n,e,a,r,o,s){function l(n,e){return function(n,e){angular.forEach(n,function(n,t){(function(n){return n.name&&n.short})(n)&&s.addEditor(e,{name:n.short,fullName:n.name,page:n.url,mail:n.address})})}(t.toAry(n.treebank.annotator||[]),e),function(n,e){return n.map(function(n){var i=function(n){var e=n._cite;if(e)return e;var t=n._document_id,i=n._subdoc;return i?t+":"+i:t}(n);return t.toAry(n.word),c(n,n._id,e,i)})}(t.toAry(n.treebank.sentence),e)}function c(n,e,r,s){var l=i.toAry(n.word),c={},d=function(n,e){return t.inject({},n,function(n,t,i){!function(n,e,t){e._artificial&&(n[e._id]=h(e._insertion_id,t))}(n,t,e)})}(l,e),g=l.length-1;angular.forEach(l,function(n,t){var i=u(n,e,r,d);t===g&&(i.terminator=!0),c[i.id]=i});var f=o.sentence(c,s);return a.generateId(f,e,e,r),f}function u(n,e,t,i){var r=o.token(n._form,e);(function(n,e){n.morphology={lemma:e._lemma,postag:e._postag},n.morphology.origin="document";var t=e._gloss;t&&(n.morphology.gloss=t)})(r,n),function(n,e){var t=e._relation,i=t&&"nil"!==t?t:"";n.relation={label:i}}(r,n),function(n,e){var t=e._sg;t&&!t.match(/^\s*$/)&&(n.sg={ancestors:t.split(" ")})}(r,n),function(n,e){e._artificial&&(n.artificial=!0,n.type=e._artificial)}(r,n),d(r,n,i),function(n,e){var t=e._comment;t&&(n.comment=t)}(r,n);var s=g(n,e),l=n._id;return a.generateId(r,s,l,t),r}function d(n,e,t){var i=e._head;if(angular.isDefined(i)&&""!==i){var a={},o=t[i],s=n.sentenceId;a.id=o||r.getId(i,s),n.head=a}}function g(n,e){return n._artificial?h(n._insertion_id,e):r.getId(n._id,e)}function h(n,e){return n.match(/-/)?n:r.padIdWithSId(n,e)}return function(i){var r=this,s=n.provideResource(i.resource),c=i.docIdentifier;this.preselections=a.getPreselections(i),this.parse=function(n,i){var a=t.xml2json(n),r=function(n){var e=n.treebank.link,i=e?t.toAry(e):[],a=t.inject({},i,function(n,e){n[e._title]=e._href}),r=n.treebank._format;return r&&("aldt"==r&&(r="aldt2"+n.treebank["_xml:lang"]),a.fullFile=r),a}(a),s=o.doc(n,a,r);e.addDocument(c,s),i(l(a,c))},this.get=function(n,e){e||(e=n,n={}),s.get(n).then(function(n){r.parse(n.data,e)})}}}]),angular.module("arethusa").service("retrieverHelper",["idHandler","locator",function(n,e){this.generateId=function(e,t,i,a){var r=new n.Map;r.add(a,t,i,e.sentenceId),e.id=t,e.idMap=r},this.getPreselections=function(a){var r=i.toAry(e.get(a.preselector));return t.map(r,function(e){return n.getId(e)})}}]),angular.module("arethusa").constant("VERSION",{revision:"449ee3e5eb26fba7ede57b24be71aac565de0667",branch:"master",version:"0.2.5",date:"2017-06-07T14:58:53.301Z",repository:"http://github.com/latin-language-toolkit/arethusa"}),angular.module("arethusa").run(["$templateCache",function(n){"use strict";n.put("js/templates/conf_editor.html",'<arethusa-navbar></arethusa-navbar>\n\n<div class="row panel">\n  <div class="colums small-12">\n    <h3>Conf editor</h3>\n      <strong>{{ fileName() }}</strong>\n    <div>\n      <ul class="button-group right">\n        <li><button ng-click="save()" class="small">Save</button></li>\n        <li><button ng-clikc="saveAs()" class="small">Save as...</button></li>\n        \x3c!--needs something like dropdown where we can enter a new filename--\x3e\n        <li><button ng-click="reset()" class="small">Reset</button></li>\n        <li><button ng-click="toggleDebugMode()" class="small">Debug</button></li>\n      </ul>\n    </div>\n  </div>\n  <div debug="conf"></div>\n</div>\n\n<div class="row panel">\n  <div class="columns large-12">\n    <div class="columns large-3">\n      <simple-form text="Main Template" model="main().template"></simple-form>\n      <input type="checkbox" ng-model="main().colorize"/><label>Colorize tokens</label>\n    </div>\n  </div>\n</div>\n\n<div class="row panel">\n  <h5>Data Sources</h5>\n    \x3c!--this is going to be a directive once the markup takes--\x3e\n    \x3c!--more shape--\x3e\n    <ul class="button-group">\n      <li ng-repeat="(name, conf) in main().retrievers"\n          ng-click="toggleSelection(\'source\', name)">\n        <span class="tiny button">\n          {{ name }}\n        </span>\n      </li>\n    </ul>\n    <div ng-repeat="(name, conf) in main().retrievers" ng-show="isSelected(\'source\', name)">\n      \x3c!--\n        Note on the remover attribute: We pass a function here through a\n        one-way binding here. This function takes an argument, in this case\n        removePlugin() takes the name of the plugin to remove. The name of this\n        param in the attribute declaration is meaningless. It\'s just here to tell\n        the pluginConf directive (which is in an isolated scope) that the function\n        in fact takes an argument. It wouldn\'t need to be name here, it could be\n        \'foo\' too.\n      --\x3e\n      <retriever-conf\n        name="name"\n        retriever="main().retrievers[name]"\n        remover="removeDataSource(name)">\n      </retriever-conf>\n    </div>\n    <conf-adder\n      text="Add a data source"\n      submitter="addDataSource(input)">\n    </conf-adder>\n</div>\n\n<div class="row panel">\n  <h5>Plugins</h5>\n  <div>\n    <ul class="button-group">\n      <li ng-repeat="name in main().plugins">\n        <span\n          class="tiny button"\n          ng-class="{alert: isMainPlugin(name)}"\n          ng-click="toggleSelection(\'plugin\', name)">\n          {{ name }}\n        </span>\n      </li>\n    </ul>\n  </div>\n  <div ng-repeat="name in main().plugins" ng-show="isSelected(\'plugin\', name)">\n    <plugin-conf name="name"></plugin-conf>\n  </div>\n  <conf-adder\n    text="Add a plugin"\n    submitter="addPlugin(input)">\n  </conf-adder>\n</div>\n\n<div class="row panel">\n  <h5>Resources</h5>\n  <div>\n    <ul class="button-group">\n      <li ng-repeat="(name, resource) in resources()">\n        <span class="tiny button" ng-click="toggleSelection(\'resource\', name)">\n          {{ name }}\n        </span>\n      </li>\n    </ul>\n  </div>\n  <div ng-repeat="(name, resource) in resources()" ng-show="isSelected(\'resource\', name)">\n    <resource-conf\n      name="name"\n      resource="resource"\n      remover="removeResource(name)">\n    </resource-conf>\n  </div>\n  <conf-adder\n    text="Create a resource"\n    submitter="addResource(input)">\n  </conf-adder>\n</div>\n\n<div class="row panel">\n  <h5>Navbar</h5>\n  <div class="columns large-3">\n    <simple-form text="Template" model="navbar().template"></simple-form>\n    <span ng-repeat="key in navbarBooleans">\n      <input type="checkbox" ng-model="navbar()[key]"/><label>{{ key }}</label>\n    </span>\n  </div>\n</div>\n'),n.put("js/templates/dep_tree.html",'<div class="tree-canvas">\n  <div class="tree-settings">\n    <span token-selector="state.tokens"></span>\n    <span\n      class="note right settings-span-button"\n      ng-show="plugin.diffPresent"\n      ng-click="plugin.toggleDiff()">\n      Toggle Diff\n    </span>\n  </div>\n\n  <div\n    lang-specific\n    dependency-tree\n    tokens="state.tokens"\n    styles="plugin.diffStyles()"\n    to-bottom>\n  </div>\n</div>\n'),n.put("js/templates/dep_tree2.html",'<div>\n  <div class="tree-settings">\n    <span token-selector="state.tokens"></span>\n    <span\n      class="note right settings-span-button"\n      ng-show="plugin.diffPresent"\n      ng-click="plugin.toggleDiff()">\n      Toggle Diff\n    </span>\n    <span\n      class="note right settings-span-button"\n      style="margin-left: 10px"\n      unused-token-highlighter\n      uth-check-property="head.id">\n    </span>\n  </div>\n\n  <div\n    lang-specific\n    dependency-tree\n    tokens="state.tokens"\n    styles="plugin.diffStyles()"\n    to-bottom>\n  </div>\n</div>\n'),n.put("js/templates/exercise_demo.html",'<arethusa-navbar></arethusa-navbar>\n<p/>\n<div id="canvas" class="row panel full-height" full-height>\n  <div id="main-body" class="columns small-7">\n    <div ng-repeat="pl in mainPlugins">\n      <plugin name="pl"/>\n    </div>\n  </div>\n\n  <div id="sidepanel" class="columns small-5">\n    <div id="sidepanel-resizer" full-height resizable></div>\n    <div id="sidepanel-body">\n      <tabset>\n        <tab\n          ng-click="declareActive(pl.name)"\n          ng-repeat="pl in subPlugins"\n          heading="{{ pl.name }}">\n          <plugin name="pl" ng-if="isActive(pl)"/>\n        </tab>\n      </tabset>\n    </div>\n  </div>\n</div>\n'),n.put("js/templates/external_history.html",'<p>(jQuery implementation)</p>\n\n<span id="undo" class="label radius">Undo</span>\n<span id="redo" class="label radius">Redo</span>\n<div id="ext-hist-elements"></div>\n\n<script src="./js/other/external_history.js"><\/script>\n'),n.put("js/templates/history.html",'<div>\n  <span class="settings-span-button right" hist-redo/>\n  <span class="settings-span-button right" hist-undo/>\n  <div delimiter/>\n  <div history-list/>\n</div>\n'),n.put("js/templates/landing_page.html",'<arethusa-navbar></arethusa-navbar>\n\n<div class="canvas-border"></div>\n\n<div class="panel row large-12 columns">\n  <div class="section">\n    <a href="https://github.com/latin-language-toolkit/arethusa"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"/></a>\n    <p class="italic"><span translate="landing.description"/></p>\n    <p><span translate="landing.goalsDescription"/></p>\n\n    <div style="margin: auto">\n      <img src="../dist/examples/images/grid.png" style="display: block; padding: 0 2rem; margin: auto"/>\n    </div>\n  </div>\n\n  <div class="large-12 columns" style="padding: 1rem 0"/>\n\n  <div class=section>\n    <h3><span translate="useCases"/></h3>\n    <p><span translate="landing.modularNature"/></p>\n\n    <div class="large-12 columns">\n      <div ng-repeat="useCase in useCases">\n        <h3 class="italic"><span translate="{{ useCase.name }}"/></h4>\n        <div ng-repeat="example in useCase.examples">\n          <div\n            class="large-4 columns panel clickable"\n            ng-click="goTo(example.url)">\n            <h4 translate="{{ example.name }}"></h4>\n            <img ng-src="{{ example.img }}"/>\n            <p>{{ example.caption }}</p>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n\n  <div class="large-12 columns" style="padding: 1rem 0"/>\n\n  <div class="section">\n    <h3><span translate="gettingStarted"/></h3>\n    <iframe width="640" height="360" src="//www.youtube.com/embed/FbRRoVnVuDs" frameborder="0" allowfullscreen></iframe>\n    <iframe width="640" height="360" src="//www.youtube.com/embed/hp-bhasd96g" frameborder="0" allowfullscreen></iframe>\n    <p>\n    <a href="http://sites.tufts.edu/perseids/instructions/screencasts/"><span translate="landing.moreScreencasts"/></a>\n    </p>\n  </div>\n\n  <div class="large-12 columns" style="padding: 1rem 0"/>\n\n  <div class="section">\n    <h3><span translate="development"/></h3>\n    <p><span translate="landing.devDescription"/></p>\n  </div>\n\n  <div class="large-12 columns" style="padding: 1rem 0"/>\n\n  <div style="section">\n    <h3><span translate="landing.partners"/></h3>\n    <div class="large-12 columns">\n      <div class="img-container" style="display: inline-block">\n        <a href="{{ partners[0].href }}">\n          <img class="center" style="height: 200px" ng-src="{{ partners[0].img }}"/>\n        </a>\n      </div>\n      <div class="img-container" style="display: inline-block">\n        <a href="{{ partners[1].href }}">\n          <img class="center" style="height: 150px" ng-src="{{ partners[1].img }}"/>\n        </a>\n      </div>\n      <div class="img-container" style="display: inline-block">\n        <a href="{{ partners[2].href }}" target="_blank">\n          <img class="center" style="height: 70px; margin: 2rem" ng-src="{{ partners[2].img }}"/>\n        </a>\n      </div>\n      <div class="img-container" style="display: inline-block">\n        <a href="{{ partners[3].href }}" target="_blank">\n          <img class="center" style="height: 200px" ng-src="{{ partners[3].img }}"/>\n        </a>\n      </div>\n    </div>\n    <p>\n  </div>\n\n  <div class="large-12 columns" style="padding: 1rem 0"/>\n\n  <div style="section">\n    <h3><span translate="landing.awards"/></h3>\n    <div class="large-12 columns">\n      <div class="img-container" style="display: inline-block">\n        <a href="{{ awards[0].href }}">\n          <img class="center" style="height: 120px" ng-src="{{ awards[0].img }}"/>\n        </a>\n      </div>\n    </div>\n  </div>\n\n  <div class="large-12 columns" style="padding: 1rem 0"/>\n\n  <div>\n    <h3><span translate="landing.funders"/></h3>\n    <p><span translate="landing.fundersDescription"/></p>\n  </div>\n</div>\n\n'),n.put("js/templates/main.html",'<div class="row panel">\n  <div class="columns small-12">\n    <h3>Main Controller</h3>\n    Selected tokens: {{ state.currentTokensAsStringList() }}\n  </div>\n</div>\n\n<div ng-repeat="pl in plugins" class="row panel">\n  <div class="columns small-12">\n    <plugin name="{{ pl }}"/>\n  </div>\n</div>\n'),n.put("js/templates/main2.html",'<arethusa-navbar></arethusa-navbar>\n\n<div class="row panel">\n  <div class="columns small-12">\n    <div>\n      <h3>Main State</h3>\n      <p>\n        {{ state.selectedTokens }}\n        <button deselector class="right small">Deselect all</button>\n        <button ng-click="toggleDebugMode()" class="right small">Debug</button>\n      </p>\n    </div>\n    <div debug="state.tokens"></div>\n  </div>\n</div>\n\n\n<div class="row panel full-height">\n  <div class="columns small-6">\n    <div ng-repeat="pl in mainPlugins">\n      <plugin name="pl"/>\n      <hr>\n    </div>\n  </div>\n\n  <div class="columns small-6">\n    <tabset>\n      <tab ng-repeat="pl in subPlugins" heading="{{ pl.name }}">\n        <plugin name="pl"/>\n      </tab>\n    </tabset>\n  </div>\n</div>\n'),n.put("js/templates/main3.html",'<arethusa-navbar></arethusa-navbar>\n\n<div class="canvas-border"></div>\n\n<div class="panel">\n<a href="https://github.com/latin-language-toolkit/arethusa"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/e7bbb0521b397edbd5fe43e7f760759336b5e05f/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677265656e5f3030373230302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_green_007200.png"></a>\n<h3>Arethusa</h3>\n<p>TODO description</p>\n\n<h3>Use cases or configurations</h3>\n<p>Through its modular nature Arethusa can be configured for different use cases:<p>\nTODO\n<div class="row" data-equalizer>\n  <div class="large-4 columns panel" data-equalizer-watch>\n    <h4>Treebanking</h4>\n    TODO description\n    <a href="/app/#/staging2?doc=1&s=2">Example</a>\n    TODO image\n  </div>\n  <div class="large-4 columns panel" data-equalizer-watch>\n    <h4>Review mode</h4>\n    <a href="/app/#/review_test?doc=1&gold=11">Example</a>\n  </div>\n  <div class="large-4 columns panel" data-equalizer-watch>\n    <h4>Review mode</h4>\n    <a href="/app/#/review_test?doc=1&gold=11">Example</a>\n  </div>\n</div>\nThe new Grid layout\nhttp://localhost:8081/app/#/staging3?doc=1\n\n\n\nA Greek document, including the SG plugin\nhttp://localhost:8081/app/#/sg?doc=athenaeus12&s=1\n\nAn empty document to play around (saving disabled)\nhttp://localhost:8081/app/#/clean?doc=clean1\n\n<h3>Getting started</h3>\n<iframe width="640" height="360" src="//www.youtube.com/embed/FbRRoVnVuDs" frameborder="0" allowfullscreen></iframe>\n<iframe width="640" height="360" src="//www.youtube.com/embed/hp-bhasd96g" frameborder="0" allowfullscreen></iframe>\n<p>\n<a href="http://sites.tufts.edu/perseids/instructions/screencasts/">More screencasts</a>\n</p>\n\n<h3>Development</h3>\n<p>\nArethusa is built on the <a href="https://angularjs.org/angular.js">AngularJS</a> javascript web application framework \nand provides a back-end independent plugin infrastructure for accessing texts, annotations and linguistic services from a variety of sources. \nExtensibility is a guiding design goal - Arethusa includes tools for automatic generation of new plugin skeletons \n(<a href="https://github.com/latin-language-toolkit/arethusa-cli">Arethusa::CLI</a>) and detailed development guides are currently in progress (TODO link?), \nwith the hopes that others will be able to reuse and build upon the platform to add support for other annotation types, \nlanguages and back-end repositories and workflow engines.\n</p>\n\n\n<h3>Funders</h3>\n<p>This project has received support from the <a href="http://www.mellon.org/">Andrew W. Mellon Foundation</a> and the <a href="http://imls.gov/">Institute of Museum and Library Services</a>.</p>\n</div>\n\n'),n.put("js/templates/main_grid.html",'<div>\n  <div id="arethusa-editor">\n    <div class="canvas-border"/>\n\n    <div arethusa-grid/>\n\n    <div arethusa-context-menus tokens="state.tokens" plugins="plugins.withMenu"/>\n  </div>\n  <div notifications/>\n  <div id="arethusa-sentence-list" class="hide"/>\n</div>\n'),n.put("js/templates/main_grid_widget.html",'<div>\n  <div id="arethusa-editor">\n    <div class="canvas-border"/>\n\n    <div arethusa-grid/>\n\n    <div arethusa-context-menus tokens="state.tokens" plugins="plugins.withMenu"/>\n  </div>\n  <div notifications/>\n  <div id="arethusa-sentence-list" class="hide"/>\n  <arethusa-navbar/>\n</div>\n'),n.put("js/templates/main_with_sidepanel.html",'<div>\n  <div id="arethusa-editor">\n    <div class="canvas-border"/>\n\n    <div id="canvas" class="row panel full-height" full-height>\n      <div id="main-body" to-bottom>\n        <div ng-repeat="pl in plugins.main" plugin name="{{ pl.name }}"/>\n        <div keys-to-screen/>\n      </div>\n\n      <div id="sidepanel" sidepanel to-bottom class="scrollable">\n        <div id="sidepanel-resizer" resizable to-bottom></div>\n        <div id="sidepanel-body" arethusa-tabs="plugins.sub"/>\n      </div>\n    </div>\n\n    <div arethusa-context-menus tokens="state.tokens" plugins="plugins.withMenu"/>\n  </div>\n  <div notifications/>\n  <div id="arethusa-sentence-list" class="hide"/>\n</div>\n'),n.put("js/templates/morph.html",'<h3>Morph plugin</h3>\n<ul>\n  <li ng-repeat="analysis in plugin.currentAnalyses()">\n    Forms of {{ analysis.string}}\n    <ol>\n      <li ng-repeat="form in analysis.forms">\n        <morph-form></morph-form>\n      </li>\n    </ol>\n  </li>\n</ul>\n'),n.put("js/templates/morph2.html",'<div class="right">\n  <prev-token><span class="label radius">prev</span></prev-token>\n  <next-token><span class="label radius">next</span></next-token>\n</div>\n\n\x3c!--{{ plugin.analyses }}--\x3e\n\n<div ng-repeat="(id, analysis) in plugin.currentAnalyses()">\n  <p token-with-id value="analysis.string" token-id="id"/>\n  <accordion close-others="oneAtATime">\n    <accordion-group ng-repeat="form in analysis.forms" >\n      <accordion-heading>\n         <div class="row">\n           <div class="columns small-5">\n             • <span ng-style="plugin.styleOf(form)">{{ form.lemma }}\n             <br>\n             </span> {{ plugin.concatenatedAttributes(form) }}\n           </div>\n           <div class="columns small-2">{{ form.postag }}</div>\n           <div class="columns small-2 note">{{ form.origin }}</div>\n           <div form-selector class="columns small-2 right end"></div>\n         </div>\n      </accordion-heading>\n      <morph-form-edit></morph-form-edit>\n    </accordion-group>\n    <accordion-group heading="Create new form">\n      <morph-form-create></morph-form-create>\n    </accordion-group>\n  </accordion>\n</div>\n'),n.put("js/templates/morph3.html",'<div\n  class="note right span-settings-button"\n  style="margin-top: 10px"\n  unused-token-highlighter\n  uth-check-property="morphology"\n  uth-auxiliary-property="postag">\n</div>\n\n<div ng-repeat="(id, analysis) in plugin.currentAnalyses()">\n  <div class="small-12 columns" lang-specific>\n    <p token-with-id value="analysis.string" token-id="id"/>\n    <p ng-if="plugin.gloss">\n      <label>\n        <span translate="morph.lemmaTranslation"/>\n        <input class="compact"\n          type="text"\n          ng-change="plugin.updateGloss(id)"\n          ng-model="analysis.gloss">\n        </input>\n      </label>\n    </p>\n    <accordion close-others="oneAtATime">\n      <accordion-group\n        ng-repeat="form in analysis.forms"\n        is-open="plugin.expandSelection && form.selected">\n        <accordion-heading>\n          <div class="row" accordion-highlighter>\n            <div form-selector class="columns large-1 small-1"></div>\n            <div class="columns large-3 small-5 text">\n              <span ng-style="plugin.styleOf(form)" lang-specific>{{ form.lemma }}\n              <br>\n              </span> {{ plugin.concatenatedAttributes(form) }}\n            </div>\n            <div\n              class="columns large-4 small-5 postag">\n              {{ form.postag }}\n            </div>\n            <div class="columns large-1 hide-for-small hide-for-medium note end">{{ form.origin }}</div>\n          </div>\n          <hr class="small">\n        </accordion-heading>\n        <div class="small-12 columns" morph-form-attributes="form" token-id="id"></div>\n        <p class="small-12 columns"/>\n        <hr>\n      </accordion-group>\n    </accordion>\n  </div>\n  <div ng-if="plugin.canEdit()">\n    <div class="small-6 columns">\n      <button\n        reveal-toggle="mfc{{ id }}"\n        class="micro radius">\n        <span translate="morph.createNewForm"/>\n      </button>\n    </div>\n    <morph-form-create\n      id="mfc{{ id }}"\n      morph-id="id"\n      morph-token="analysis"\n      class="hide">\n    </morph-form-create>\n  </div>\n  <div delimiter/>\n</div>\n'),n.put("js/templates/morph3.widget.html",'<div ng-repeat="(id, analysis) in plugin.currentAnalyses()">\n  <div class="small-12 columns" lang-specific>\n    <accordion close-others="oneAtATime">\n      <accordion-group\n        ng-repeat="form in analysis.forms"\n        is-open="plugin.expandSelection && form.selected">\n        <accordion-heading>\n          <div class="row" accordion-highlighter>\n            <div class="columns large-3 small-5 text">\n              <span ng-style="plugin.styleOf(form)" lang-specific>{{ form.lemma }}\n              <br>\n              </span> {{ plugin.concatenatedAttributes(form) }}\n            </div>\n            <div\n              class="columns large-4 small-5 postag">\n              {{ form.postag }}\n            </div>\n            <div class="columns large-1 hide-for-small hide-for-medium note end">{{ form.origin }}</div>\n          </div>\n          <hr class="small">\n        </accordion-heading>\n        <div class="small-12 columns" morph-form-attributes="form" token-id="id"></div>\n        <p class="small-12 columns"/>\n        <hr>\n      </accordion-group>\n    </accordion>\n  </div>\n</div>\n'),n.put("js/templates/morph_form.html",'<ul>\n  <li ng-repeat="(attr, val) in form.attributes">\n    {{ plugin.longAttributeName(attr) }}: {{ plugin.abbrevAttributeValue(attr, val) }}\n  </li>\n</ul>\n'),n.put("js/templates/morph_form_create.html",'<div class="small-6 columns">\n  <ul class="button-group right">\n    <li>\n      <span\n        class="button micro radius"\n        ng-click="reset()"\n        translate="reset">\n      </span>\n    </li>\n    <li>\n      <span\n        class="button micro radius"\n        ng-click="save(mFCForm.$valid)"\n        translate="save">\n      </span>\n    </li>\n  </ul>\n</div>\n\n<div delimiter></div>\n\n<form name="mFCForm">\n  <div class="small-12 columns">\n    <alert\n      ng-if="alert"\n      class="radius center fade-in error"\n      close="resetAlert()">\n      {{ translations.createError() }}\n    </alert>\n  </div>\n\n  <div class="small-12 columns">\n    <div class="small-3 columns">\n      <label class="right">Lemma</label>\n    </div>\n    <div class="small-9 columns">\n      <ng-form\n        id="lemma-form"\n        tooltip-placement="top"\n        tooltip="{{ lemmaHint }}">\n        <input\n          foreign-keys\n          class="compact error"\n          type="text"\n          required\n          ng-change="declareOk()"\n          ng-model="form.lemma">\n        </input>\n      </ng-form>\n    </div>\n  </div>\n\n  <div\n    ng-repeat="attr in visibleAttributes"\n    ng-init="options= m.attributeValues(attr)">\n    <div class="small-12 columns">\n      <div class="small-3 columns">\n        <label class="right">{{ m.longAttributeName(attr) }}</label>\n      </div>\n\n      <div class="small-9 columns">\n        <select\n          class="compact"\n          required\n          ng-model="form.attributes[attr]"\n          ng-options="options[key].long for key in options | keys"\n          ng-change="m.updatePostag(form, attr, form.attributes[attr])">\n        </select>\n      </div>\n    </div>\n  </div>\n</form>\n'),n.put("js/templates/morph_form_edit.html",'<div class="row" ng-repeat="(attr, val) in form.attributes">\n  <div class="small-3 columns">\n    <label class="right">{{ plugin.longAttributeName(attr) }}</label>\n  </div>\n\n  <div class="small-9 columns">\n    <select\n      ng-model="form.attributes[attr]"\n      ng-init="opt.short"\n      ng-options="name as opt.long for (name, opt) in plugin.attributeValues(attr)"\n'+"      fire-event=\"{target: 'form', property: 'attr', value: 'val'}\"\n      synchronize-postag=\"{form: 'form', attr: 'attr', val: 'val'}\">\n    </select>\n  </div>\n</div>\n<small ng-show=\"form.lexInvUri\">Lexical Inventory: {{ form.lexInvUri }}</small>\n"),n.put("js/templates/navbar.widget.html",'<div class="absolute_top">\n  <nav class="top-bar" data-topbar>\n    <ul class="title-area">\n      <li class="name">\n      <h1><a href="#"><img ng-src="{{ logo }}"/></a></h1>\n      </li>\n    </ul>\n    <section class="top-bar-section">\n      <ul navbar-navigation/>\n    </section>\n  </nav>\n</div>\n<div help-panel class="hide row panel"/>\n<div global-settings-panel class="hide row panel"/>\n'),n.put("js/templates/navbar1.html",'<div class="fixed">\n  <nav class="top-bar" data-topbar>\n    <ul class="title-area">\n      <li class="name">\n      <h1><a href="#"><img ng-src="{{ logo }}"/></a></h1>\n      </li>\n    </ul>\n    <section class="top-bar-section">\n      <ul navbar-search/>\n      <ul navbar-navigation/>\n      <ul navbar-buttons class="right"/>\n    </section>\n  </nav>\n</div>\n<div help-panel class="hide row panel"/>\n<div global-settings-panel class="hide row panel"/>\n'),n.put("js/templates/navbar_landing.html",'<div class="fixed">\n  <nav class="top-bar" data-topbar>\n    <ul class="title-area">\n      <li class="name">\n      <h1><a href="#"><img ng-src="{{ logo }}"/></a></h1>\n      </li>\n    </ul>\n    <section class="top-bar-section">\n      <ul class=" has-form right">\n        <li><a class="button" translate-language/></li>\n      </ul>\n    </section>\n  </nav>\n</div>\n'),n.put("js/templates/relation.html",'<div\n  class="note right span-settings-button"\n  style="margin-top: 10px"\n  unused-token-highlighter\n  uth-check-property="relation.label">\n</div>\n\n<div ng-if="plugin.advancedMode">\n  <div relation-multi-changer class="small-12 columns"/>\n  <div delimiter/>\n</div>\n\n<div ng-repeat="(id, obj) in plugin.currentLabels()">\n    <div class="small-12 columns" style="padding-bottom: 1rem">\n      <div token-with-id value="obj.string" token-id="id" style="padding-bottom: .4rem"/>\n      <div label-selector obj="obj.relation"/>\n        <syntactical-description\n          ng-if="plugin.syntaxDescriptions"\n          token-id="id">\n        </syntactical-description>\n    </div>\n</div>\n\n'),n.put("js/templates/search.html",'<div class="small-12 columns">\n  <div search-by-string/>\n</div>\n\n<div class="small-12 columns" ng-repeat="pl in plugin.searchPlugins">\n  <div plugin-search="pl"></div>\n</div>\n\n<div class="small-12 columns">\n  <label class="inline">\n    <span translate="search.foundTokens"/>\n  </label>\n  <ul lang-specific>\n    <li\n      ng-repeat="(id, type) in state.selectedTokens"\n      class="fade fast clickable"\n      ng-mouseenter="hovered = true"\n      ng-mouseleave="hovered = false"\n      ng-class="{ \'search-result-hovered\': hovered }"\n      ng-click="state.deselectToken(id, type)"\n      token-with-id\n      value="state.asString(id)"\n      token-id="id">\n    </li>\n  </ul>\n</div>\n'),n.put("js/templates/sg.html",'<div class="small-12 columns">\n  <div ng-repeat="(id, grammar) in plugin.currentGrammar()">\n    <p token-with-id value="grammar.string" token-id="id"/>\n    <p class="text" style="margin-left: 0.75rem">{{ grammar.hint }}</p>\n    <div ng-hide="grammar.hint">\n      <div sg-ancestors="grammar"/>\n      <br/>\n      <ul ng-if="plugin.canEdit()" class="nested-dropdown">\n        <li class="first-item">Select Smyth Categories\n          <ul\n            class="top-menu"\n            nested-menu-collection\n            property=""\n            current="grammar"\n            ancestors="plugin.defineAncestors"\n            all="grammar.menu"\n            label-as="plugin.labelAs"\n            empty-val="true">\n          </ul>\n        </li>\n      </ul>\n    </div>\n  </div>\n\n  <div sg-grammar-reader>\n  </div>\n</div>\n'),n.put("js/templates/text.html",'<h3>Text plugin</h3>\n<table>\n  <tr>\n    <td ng-repeat="token in state.tokens">\n      {{ token.id }}\n    </td>\n  </tr>\n  <tr>\n      \x3c!--this mouse behavior should get moved\n          inside the token directive eventually--\x3e\n    <td\n      ng-repeat="token in state.tokens"\n      ng-click="state.toggleSelection(token.id, \'click\')"\n      ng-mouseenter="state.selectToken(token.id, \'hover\')"\n      ng-mouseleave="state.deselectToken(token.id, \'hover\')">\n      <token ng-class="{selected: state.isSelected(token.id)}"></token>\n    </td>\n  </tr>\n</table>\n'),n.put("js/templates/text2.html",'<p lang-specific>\n  <span ng-repeat="token in plugin.tokens">\n    <span\n      token="token"\n      colorize="true"\n      click="true"\n      hover="true"\n      highlight="true">\n    </span>\n    \x3c!--Deactivated for now - not safe to use with ellipsis--\x3e\n    \x3c!--<br ng-if="token.terminator && !$last"/>--\x3e\n  </span>\n</p>\n'),n.put("js/templates/text_with_context.html",'<p lang-specific>\n  <span\n    ng-if="plugin.showContext"\n    text-context="plugin.context.pre">\n  </span>\n  <span ng-repeat="token in plugin.tokens">\n    <span\n      token="token"\n      colorize="true"\n      click="true"\n      hover="true"\n      highlight="true">\n    </span>\n  </span>\n  <span\n    ng-if="plugin.showContext"\n    text-context="plugin.context.post">\n  </span>\n</p>\n\n'),n.put("js/templates/token.html",'\x3c!--tcm is for tokenContextMenu--\x3e\n<span\n  ng-class="selectionClass()"\n  context-menu\n  menu-trigger="rightclick"\n  menu-id="tcm{{ token.id }}"\n  menu-position="bottom"\n  menu-obj="token">{{ token.string }}</span>\n'),n.put("js/templates/tree.html",'<arethusa-navbar></arethusa-navbar>\n\n<div class="row panel">\n  <div class="columns small-12">\n    <div>\n      <h3>Main State</h3>\n      <p>\n        {{ state.selectedTokens }}\n        <button deselector class="right small">Deselect all</button>\n        <button ng-click="toggleDebugMode()" class="right small">Debug</button>\n      </p>\n    </div>\n    <div debug="state.tokens"></div>\n  </div>\n</div>\n\n\n<div class="row panel full-height">\n  <div class="columns small-12">\n    <div ng-repeat="pl in mainPlugins">\n      <plugin name="pl"/>\n      <hr>\n    </div>\n  </div>\n</div>\n\n'),n.put("js/templates/widget.html",'<div>\n  <div id="arethusa-editor">\n    <div class="canvas-border"/>\n\n    <div id="canvas" class="row panel full-height" full-height>\n      <div id="main-body" class="widget" to-bottom>\n        <div arethusa-context-menus tokens="state.tokens" plugins="plugins.withMenu"/>\n        <div ng-repeat="pl in plugins.main" plugin name="{{ pl.name }}"/>\n        <div keys-to-screen/>\n      </div>\n    </div>\n  </div>\n  <div notifications/>\n  <arethusa-navbar/>\n  <div id="arethusa-sentence-list" class="hide"/>\n</div>\n')}])}}]);
//# sourceMappingURL=0.alpheios-components.js.map